<!doctype html>
<html>

<head>
    <script async src="https://cdn.splitbee.io/sb.js"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="referrer" content="always">
    <link rel="alternate" type="application/atom+xml" title="RSS 2.0" href="/atom.xml">
    <link rel="canonical" href="https://ntheanh201.vercel.app/articles/glitchtip-an-application-performance-monitoring-open-source.html"/>
    

    
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:site" content="@ntheanh201">
    <meta name="twitter:title" content="Glitchtip: an Application Performance Monitoring open source">
    
    <meta name="twitter:creator" content="@ntheanh201">
    
    <meta name="twitter:image" content="https://ntheanh201.vercel.app">
     

    
    <meta property="og:title" content="Glitchtip: an Application Performance Monitoring open source">
    <meta property="og:type" content="article"/>
    <meta property="og:url" content="https://ntheanh201.vercel.app/articles/glitchtip-an-application-performance-monitoring-open-source.html"/>
     
    <meta property="og:image" content="https://ntheanh201.vercel.app">
    

    <title>Glitchtip: an Application Performance Monitoring open source</title>

    <link href="/css/main.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
    <script type="text/javascript">
        function showcontact() {
            var el = document.getElementById("contact-form");
            el.style.display = "block";
            el = document.getElementById("contact-page-url");
            var uri = window.location.href;
            uri = uri.replace("#", "");
            el.value = uri;
            el = document.getElementById("msg-for-chris");
            el.focus();
        }

        function hidecontact() {
            var el = document.getElementById("contact-form");
            el.style.display = "none";
        }

        function isWindows() {
            return window.navigator &&
                window.navigator.platform &&
                window.navigator.platform.indexOf('Win') >= 0
        }

        function maybeShowAd() {
            
            

        }

        function onLoaded() {
            maybeShowAd();
        }

        document.addEventListener("DOMContentLoaded", onLoaded);
    </script>
    <script type="text/javascript">
        var galleries = {}; 
        function buildGalleriesInfo() {
            var els = document.getElementsByTagName("img");
            var n = els.length;
            for (var i = 0; i < n; i++) {
                var el = els[i];
                var id = el.id;
                if (!id.startsWith("id-thumb-img-")) {
                    continue
                }
                id = id.replace("id-thumb-img-", "")
                
                var parts = id.split("-");
                var galleryID = parseInt(parts[0]);
                var imageNo = parseInt(parts[1]);
                var galleryInfo = galleries[galleryID] || {};
                galleryInfo[imageNo] = el.src;
                galleries[galleryID] = galleryInfo;
            }
            var ids = Object.keys(galleries);
            for (var gid of ids) {
                var galleryInfo = galleries[gid];
                galleryInfo.nImages = Object.keys(galleryInfo).length;
                galleryInfo.currImageNo = 0;
                changeShot(gid, 0);
            }
        }

        function changeShot(galleryID, imgNo) {
            var gi = galleries[galleryID];
            gi.currImageNo = imgNo;
            var url = gi[imgNo];
            var id = "id-gallery-" + galleryID;
            var el = document.getElementById(id);
            el.src = url;
            
            for (var i = 0; i < gi.nImages; i++) {
                id = "id-thumb-" + galleryID + "-" + i;
                el = document.getElementById(id);
                if (i == imgNo) {
                    el.classList.add("selected-img");
                } else {
                    el.classList.remove("selected-img");
                }
            }
            var els = document.getElementsByTagName("div");
            var nEls = els.length;
        }

        function imgNext(galleryID) {
            var gi = galleries[galleryID];
            var nImages = gi.nImages;
            var imgNo = gi.currImageNo;
            imgNo = (imgNo + 1) % nImages;
            changeShot(galleryID, imgNo);
        }

        function imgPrev(galleryID) {
            var gi = galleries[galleryID];
            var imgNo = gi.currImageNo - 1;
            if (imgNo < 0) {
                imgNo = gi.nImages - 1;
            }
            changeShot(galleryID, imgNo);
        }

        document.addEventListener("DOMContentLoaded", buildGalleriesInfo);
    </script>

</head>

<body>
<div id="content">
    <p class='name-header'>
        <a href="/">↫ The Anh Nguyen</a>
    </p>
    <h1>Glitchtip: an Application Performance Monitoring open source</h1>
    
    <p class="date">2023-05-04</p>
    
    <div>
        <p></p>
<div class="notion-page" id="b63dca30-db46-4c93-8ac6-b4b8b1c9ee38">
  <p id="a227b838-4faf-4148-8d63-d45b8dbdb644" class=" notion-text-block">Hi folks 👋,
  </p>
  <p id="39b65302-adb6-4355-9d69-3bf36165a949" class=" notion-text-block">Ở bài viết lần đầu tiên chia sẻ về công việc tại Viettel, mình muốn nói về công cụ để theo dõi hiệu năng và tracking lỗi cho ứng dụng mobile, đây là lần mà mình phải đưa ra quyết định lựa chọn 1 giải pháp cụ thể nào đó để giải quyết vấn đề, cảm xúc khá lo lắng vì mọi thứ hoàn toàn có thể hoạt động không đúng như dự kiến, gây tốn thời gian và có thể dẫn tới sai sót về số liệu báo cáo 🥲.
  </p>
  <p id="1f932758-4a3e-42fe-b8ba-f1d004375a2e" class=" notion-text-block">
  </p>
  <p id="89c099d7-934d-4957-b9b6-5303450a4bfa" class=" notion-text-block">Lan man là vậy, nhắc tới việc theo dõi ứng dụng mobile và error tracking, chắc hẳn đa số mọi người đều sẽ nghĩ đến Sentry chăng? 🤔
  </p>
  <h2 id="475591af-b9a1-4fec-bb62-34d394a4e8c0" class="">Yêu cầu
  </h2>
  <p id="daf267fa-9401-469f-ad00-daa250152c4e" class=" notion-text-block">Với yêu cầu được đặt ra là: bảo mật về dữ liệu và có thể tự triển khai trên hạ tầng Viettel Cloud để theo dõi lỗi cho ứng dụng <strong>VCar</strong> (được code bằng React Native), báo cáo KPI/KQI, mình đã tìm kiếm các tools với tiêu chí sau:
  </p>
  <ul id="aaed2acd-ab01-4452-8621-1eec819091b1" class="bulleted-list">
    <li>Open Source
    </li>
    <li>Dễ dàng tích hợp phía client, cụ thể ở đây cần 1 nền tảng hỗ trợ tốt React Native
    </li>
  </ul>
  <p id="14fb8342-2c43-4247-a6c6-87a4b1138143" class=" notion-text-block">Ngoài ra, còn có 1 yêu cầu nữa là có thể dùng cách nào đó để lấy dữ liệu và visualize với Grafana dùng cho việc báo cáo KPI/KQI.
  </p>
  <h2 id="b579e5f0-eda3-4d6e-9b4b-d1ef91df0c68" class="">Triển khai Sentry và những khó khăn
  </h2>
<img class="blog-img" src="/img/fa2dcd35259fc17ad4bdb6c6081ee9c3d2d18bcb.png">
  <p id="2a803d1d-b093-4a70-9148-4a03ee24af90" class=" notion-text-block">Sentry hoàn toàn đáp ứng được những yêu cầu trên, ngoài bản lưu dữ liệu trên hạ tầng Sentry, Sentry còn cung cấp bản Self-Hosted Sentry (<a href="https://develop.sentry.dev/self-hosted/">https://develop.sentry.dev/self-hosted</a>). Follow theo guide, mọi thứ hoàn toàn đẹp như mơ, hệ thống start ngon lành, suýt thì cười tươi được.
  </p>
  <p id="8ef52696-48fb-46bc-b7a6-397418353f0e" class=" notion-text-block">Vấn đề xảy ra khi mình quyết định triển khai thực tế, guide của Sentry thì hướng dẫn chạy theo dạng docker-compose, à thì tìm cách nào đó chuyển qua chạy trên hạ tầng Kubernetes là được mà, right? Và thế là cũng thử lần mò tới được 1 bản Helm charts community (<a href="https://github.com/sentry-kubernetes/charts">https://github.com/sentry-kubernetes/charts</a>), mình không nhớ chính xác từng bước chi tiết phải sửa cấu hình để có thể start lên được, nhưng phải nói rất oải 🤧, từ việc setup cho chạy thành công những job migrate db đến việc cấu hình cho Clickhouse chạy ổn định, phải chỉnh sửa đủ các kiểu version, …
  </p>
  <p id="bded2844-d639-4229-8e2e-0f9b33e2aac5" class=" notion-text-block">Chưa nói đến những bước về sau như cấu hình tên miền, … việc đặt các dữ liệu monitoring của Sentry trên Clickhouse thực sự khiến bản thân mình chưa control được luồng dữ liệu, có những dữ liệu không biết mang ý nghĩa gì, liên kết đến bảng nào, thậm chí câu chuyện dở khóc dở cười là khi mình connect tới Clickhouse, bảng có lúc thì xuất hiện đủ, lúc thì tự dưng biến mất, đến thời điểm hiện tại vẫn chưa hiểu được nguyên nhân tại sao.
  </p>
  <p id="40e01be0-7acc-4d8d-b5a2-c163e66d92f5" class=" notion-text-block">Với việc phải kiểm soát 1 hạ tầng quá phức tạp của Sentry, cộng thêm chưa thể hiểu rõ nền tảng này, mình quyết định tìm tới phương án Sentry alternative. Từ 1 người bạn mình cũng tìm hiểu được có Glitchtip (<a href="https://glitchtip.com/">https://glitchtip.com/</a>), được viết lại hoàn toàn dựa trên phiên bản opensource của Sentry (hiện tại Sentry đã không còn là opensource nữa). 
  </p>
  <h2 id="1f721bd1-63c8-4ded-b03e-b05f3f6e92ad" class="">Glitchtip
  </h2>
<img class="blog-img" src="/img/ee854a7773bc1d05cb25008ac82ffa6cf0f82c32.png">
  <h3 id="98bcef1b-24c8-4f7d-b256-3512cba29e3b" class="">Giới thiệu
  </h3>
  <p id="fc44cda8-f4cd-46c7-9c9c-55699abaa15a" class=" notion-text-block">Glitchtip cung cấp những tính năng:
  </p>
  <ul id="352b49c1-d562-46a6-bc72-c74aa9b728c8" class="bulleted-list">
    <li><strong>Error Tracking</strong>: Báo cáo, phân loại lỗi ứng dụng, website, 
    </li>
    <li><strong>Application Performance Monitoring</strong>: Theo dõi hiệu năng ứng dụng
    </li>
    <li><strong>Uptime Monitoring</strong>: GlitchTip có thể ping tới trang web và cảnh báo khi trang web không phản hồi. Nếu GlitchTip không nhận được lệnh ping, nó sẽ gửi cho bạn một cảnh báo qua email hoặc webhook.
    </li>
  </ul>
  <p id="d38bfec6-b642-461b-8174-4db3217b614b" class=" notion-text-block">Glitchtip có đáp ứng được những yêu cầu được đưa ra? Glitchtip đáp ứng đầy đủ được cơ bản những tiêu chí trên
  </p>
  <p id="37c5034f-8e8a-44aa-9799-b1d5b9ae2fef" class=" notion-text-block"><strong>Ưu điểm:</strong>
  </p>
  <ul id="d0375888-2892-43ca-bab4-dc91dffdb9f1" class="bulleted-list">
    <li>Hoàn toàn opensource: <a href="https://gitlab.com/glitchtip">https://gitlab.com/glitchtip</a> 
    </li>
    <li>Chỉ sử dụng duy nhất Postgres cho việc lưu trữ các dữ liệu về issue, monitor, … connect vào db là hoàn toàn có thể nhìn thấy rõ các trường dữ liệu.
    </li>
    <li>Dễ dàng kết nối tới db và lấy dữ liệu ra visualize bằng Grafana.
    </li>
    <li>Có official Helm charts (<a href="https://gitlab.com/glitchtip/glitchtip-helm-chart">https://gitlab.com/glitchtip/glitchtip-helm-chart</a>) giúp cho việc triển khai dễ dàng hơn khi làm việc với Sentry.
    </li>
    <li>Sử dụng chính thư viện client của Sentry cho việc gửi dữ liệu lên server.
    </li>
  </ul>
  <p id="6b4d8542-9450-44a9-8d66-3f10cc0e26ef" class=" notion-text-block"><strong>Nhược điểm:</strong>
  </p>
  <ul id="3d3b7407-ffe1-40f9-aeff-9eee0d3f402f" class="bulleted-list">
    <li>Giao diện của Glitchtip thì quá cơ bản và đơn giản, điểm này thì hoàn toàn không thể bằng Sentry được.
    </li>
    <li>Không có nhiều tính năng bằng Sentry (Session Replay, …)
    </li>
  </ul>
  <h3 id="a182470c-4bf3-4863-be12-34dc55640397" class="">Khó khăn khi triển khai
  </h3>
  <p id="d33d3656-49fa-48d0-af64-4647eafed236" class=" notion-text-block">Nhìn chung thì với việc deploy Glitchtip sẽ không có quá nhiều khó khăn, việc cần làm cẩn thận đó là đọc kĩ các thông số của các manifest trong Helm charts để thêm values cho đúng với nhu cầu là được. Ngoài ra, community của Glitchtip hoạt động khá sôi nổi: <a href="https://app.gitter.im/#/room/#GlitchTip_community:gitter.im">https://app.gitter.im/#/room/#GlitchTip_community:gitter.im</a>, hoàn toàn có thể vào nhắn tin hỏi tác giả những khó khăn gặp phải.
  </p>
  <p id="1344de58-e295-4543-9e47-d5a584123348" class=" notion-text-block"><strong>Domain</strong>
  </p>
  <p id="ed193c20-6c97-4529-aa35-c50bd0c40bfc" class=" notion-text-block">Ở team mình có 1 vấn đề gặp phải đó là không trực tiếp cấu hình được domain của sản phẩm, hoặc thêm subdomain, mặc định Glitchtip được serve tại path “/”, nên mình và anh lead đã phải bắt tay vào nghiên cứu và sửa code của chính Glitchtip. Anh lead có kinh nghiệm code Angular nên sửa code FE còn mình thì sửa code BE được viết bằng Django để có thể sửa cái path sang “/apm”. Cũng tính contribute vào Backend của Glitchtip đấy mà mình không main Python nên lại lười <strong>😂</strong>
  </p>
  <p id="c6e3eb3a-870b-4b5d-a9a2-42fbeef23bb7" class=" notion-text-block">Tiếp theo là đọc file GitlabCI rồi tự tay build lại image theo từng bước được hướng dẫn và chỉnh sửa theo như file CI → cấu hình lại image trong Deployment, update Ingress và chạy thôi nào 🚀
  </p>
  <h3 id="6347a11a-550a-4a4d-a2ac-b62b0a83b840" class="">Thành quả
  </h3>
  <p id="146b028c-c9af-434e-885b-b0c4ecc79ac9" class=" notion-text-block">Giao diện của Glitchtip
  </p>
<img class="blog-img" src="/img/a9fa12b66fed2e5742f4684cf1730af7e4919ace.png">
  <p id="6381c245-a5c4-4c4f-8f9b-438d622de02a" class=" notion-text-block">
  </p>
  <p id="332fa263-0632-4603-b054-a18843a8c044" class=" notion-text-block">Và hoàn toàn có thể tạo được Dashboard theo nhu cầu trên Grafana từ dữ liệu lấy từ db Postgres của Glitchtip phục vụ việc báo cáo (Hình ảnh mang tính chất minh hoạ, dữ liệu nhạy cảm mình xin phép không đưa lên được 😄)
  </p>
<img class="blog-img" src="/img/de68df2caddf1f45d313f2ffc265de14ee2ffcff.png">
  <p id="6fbc041e-c7f5-405a-a515-0c6381ce2253" class=" notion-text-block">Bên trên mình đã giới thiệu mọi người về 1 nền tảng có thể sử dụng để theo dõi hiệu năng ứng dụng, error tracking là Glitchtip. Thông tin chi tiết xem tại: <a href="https://glitchtip.com/">https://glitchtip.com/</a>
  </p>
  <p id="11aaf5ab-399b-4dd7-94cf-1fa44687a6d3" class=" notion-text-block">Hẹn gặp mọi người vào những bài tiếp theo 😁
  </p>
</div>
    </div>
    
    <p class='social-footer'>—
        <a href='https://facebook.com/ntheanh201'>
            @ntheanh201</a></p>
    
</div>



</body>

</html>