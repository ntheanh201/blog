<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Rails cheatsheet</title>
  <link href="s/main.css" rel="stylesheet" />
  <script src="s/main.js"></script>
</head>

<body onload="start()">
  <div class="breadcrumbs"><a href="/">Home</a> / <a href="index.html">cheatsheets</a> / Rails cheatsheet</div>
  <div class="edit">
      <a href="https://github.com/kjk/blog/blob/master/www/cheatsheets/devhints\rails.md" >edit</a>
  </div>
  <div class="toc">
<b>Helpers</b>: <a href="#css-js-packages">CSS/JS packages</a>, <a href="#forms">Forms</a><br>
<b>Controllers</b>: <a href="#before-filter">Before filter</a>, <a href="#default-url-options">Default URL options</a>, <a href="#hashes">Hashes</a>, <a href="#xml-and-json">XML and JSON</a>, <a href="#redirection">Redirection</a>, <a href="#render">Render</a>, <a href="#head-only-responses">Head-only responses</a><br>
<a href="#layouts">Layouts</a><br></div>


  <div id="start"></div>
  <div id="wrapped-content"></div>
<div id="content">
<h2 id="helpers">Helpers</h2>

<pre><code><span class="hljs-keyword">class</span> <span class="hljs-symbol">ApplicationController</span>
  <span class="hljs-symbol">helper_method</span> :<span class="hljs-symbol">logged_in</span>?

  <span class="hljs-symbol">def</span> <span class="hljs-symbol">logged_in</span>?
    &quot;<span class="hljs-symbol">Something</span>&quot;
  <span class="hljs-symbol">end</span>
<span class="hljs-symbol">end</span>
</code></pre>
<h3 id="css-js-packages">CSS/JS packages</h3>

<pre><code>stylesheet_link_tag <span class="hljs-symbol">:monkey</span>
javascript_link_tag <span class="hljs-symbol">:monkey</span>
</code></pre>
<h3 id="forms">Forms</h3>

<pre><code><span class="hljs-comment"># http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html</span>

- form_for <span class="hljs-variable">@person</span> <span class="hljs-keyword">do</span> |f|
  = f.label <span class="hljs-symbol">:first_name</span>
  = f.label <span class="hljs-symbol">:first_name</span>, <span class="hljs-string">&quot;First name&quot;</span>
  = f.text_field <span class="hljs-symbol">:first_name</span>

  = f.label <span class="hljs-symbol">:last_name&gt;</span>
  = f.text_field <span class="hljs-symbol">:last_name&gt;</span>

  - fields_for <span class="hljs-variable">@person</span>.permission <span class="hljs-keyword">do</span> |fields|
    = fields.checkbox <span class="hljs-symbol">:admin</span>

  -<span class="hljs-comment"># name=&quot;person[admin]&quot;</span>
  - fields_for <span class="hljs-symbol">:person</span>, <span class="hljs-variable">@client</span> <span class="hljs-keyword">do</span> |fields|
    = fields.checkbox <span class="hljs-symbol">:admin</span>

  = f.submit

<span class="hljs-comment"># Also: check_box, email_field, fields_for</span>
<span class="hljs-comment"># file_field, hidden_field, label, number_field, password_field</span>
<span class="hljs-comment"># radio_button, range_field, search_field, telephonen_field,</span>
<span class="hljs-comment"># text_area, text_field, url_field</span>
</code></pre>
<h2 id="controllers">Controllers</h2>
<p><a href="http://apidock.com/rails/ActionController/Base">http://apidock.com/rails/ActionController/Base</a></p>

<pre><code><span class="hljs-keyword">class</span> <span class="hljs-symbol">ProjectsController</span>
  <span class="hljs-symbol">layout</span> &#x27;<span class="hljs-symbol">project</span>&#x27;   # <span class="hljs-symbol">Actually</span> <span class="hljs-symbol">defaults</span> <span class="hljs-symbol">to</span> `<span class="hljs-symbol">projects</span>` <span class="hljs-symbol">based</span>
                     # <span class="hljs-symbol">on</span> <span class="hljs-symbol">the</span> <span class="hljs-symbol">controller</span> <span class="hljs-symbol">name</span>

  <span class="hljs-symbol">def</span> <span class="hljs-symbol">save</span>
  <span class="hljs-symbol">end</span>

  <span class="hljs-symbol">def</span> <span class="hljs-symbol">edit</span>
  <span class="hljs-symbol">end</span>
<span class="hljs-symbol">end</span>
</code></pre>
<h3 id="before-filter">Before filter</h3>

<pre><code><span class="hljs-keyword">class</span> <span class="hljs-symbol">ApplicationController</span> &lt; <span class="hljs-symbol">ActionController::<span class="hljs-symbol">Base</span></span>
  <span class="hljs-symbol">before_filter</span> :<span class="hljs-symbol">validate, <span class="hljs-symbol">only</span>: </span>[:<span class="hljs-symbol">save, :<span class="hljs-symbol">edit</span></span>]
  <span class="hljs-symbol">before_filter</span> :<span class="hljs-symbol">ensure_auth, <span class="hljs-symbol">except</span>: </span>[:<span class="hljs-symbol">logout</span>]

  <span class="hljs-symbol">before_filter</span> :<span class="hljs-symbol">require_login</span>

  <span class="hljs-symbol">private</span>

  <span class="hljs-symbol">def</span> <span class="hljs-symbol">require_login</span>
    <span class="hljs-symbol">unless</span> <span class="hljs-symbol">logged_in</span>?
      <span class="hljs-symbol">flash</span>[:<span class="hljs-symbol">error</span>] = &quot;<span class="hljs-symbol">You</span> <span class="hljs-symbol">must</span> <span class="hljs-symbol">be</span> <span class="hljs-symbol">logged</span> <span class="hljs-symbol">in</span> <span class="hljs-symbol">to</span> <span class="hljs-symbol">access</span> <span class="hljs-symbol">this</span> <span class="hljs-symbol">section</span>&quot;
      <span class="hljs-symbol">redirect_to</span> <span class="hljs-symbol">new_login_url</span> # <span class="hljs-symbol">halts</span> <span class="hljs-symbol">request</span> <span class="hljs-symbol">cycle</span>
    <span class="hljs-symbol">end</span>
  <span class="hljs-symbol">end</span>
<span class="hljs-symbol">end</span>
</code></pre>
<h3 id="default-url-options">Default URL options</h3>

<pre><code><span class="hljs-keyword">class</span> <span class="hljs-symbol">ApplicationController</span> &lt; <span class="hljs-symbol">ActionController::<span class="hljs-symbol">Base</span></span>
  # <span class="hljs-symbol">The</span> <span class="hljs-symbol">options</span> <span class="hljs-symbol">parameter</span> <span class="hljs-symbol">is</span> <span class="hljs-symbol">the</span> <span class="hljs-symbol">hash</span> <span class="hljs-symbol">passed</span> <span class="hljs-symbol">in</span> <span class="hljs-symbol">to</span> &#x27;<span class="hljs-symbol">url_for</span>&#x27;
  <span class="hljs-symbol">def</span> <span class="hljs-symbol">default_url_options</span>(<span class="hljs-symbol">options</span>)

  <span class="hljs-symbol">end</span>
<span class="hljs-symbol">end</span>
</code></pre>
<h3 id="hashes">Hashes</h3>

<pre><code>session[<span class="hljs-symbol">:what</span>]
flash[<span class="hljs-symbol">:notice</span>] = <span class="hljs-string">&quot;Your session expired&quot;</span>
params[<span class="hljs-symbol">:id</span>]
</code></pre>
<h3 id="xml-and-json">XML and JSON</h3>

<pre><code><span class="hljs-keyword">class</span> UsersController &lt; ApplicationController
  def <span class="hljs-keyword">index</span>
    @users = <span class="hljs-keyword">User</span>.<span class="hljs-keyword">all</span>
    respond_to <span class="hljs-keyword">do</span> |<span class="hljs-keyword">format</span>|
      <span class="hljs-keyword">format</span>.html # <span class="hljs-keyword">index</span>.html.erb
      <span class="hljs-keyword">format</span>.xml  { render :<span class="hljs-type">xml</span> =&gt; @users}
      <span class="hljs-keyword">format</span>.json { render :<span class="hljs-type">json</span> =&gt; @users}
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h3 id="redirection">Redirection</h3>

<pre><code><span class="hljs-attribute">redirect_to</span> action: <span class="hljs-string">&#x27;show&#x27;</span>, id: <span class="hljs-variable">@entry</span>.id
redirect_to root_url          <span class="hljs-comment"># a path</span>
</code></pre>
<h3 id="render">Render</h3>

<pre><code>render <span class="hljs-keyword">nothing</span>: <span class="hljs-keyword">true</span>
render <span class="hljs-keyword">template</span>: <span class="hljs-string">&#x27;products/show&#x27;</span>
render status: <span class="hljs-number">500</span>
render status: :forbidden
render <span class="hljs-type">text</span>: <span class="hljs-string">&#x27;...&#x27;</span>
render layout: <span class="hljs-string">&#x27;special_layout&#x27;</span>
render layout: <span class="hljs-keyword">false</span>
render action: <span class="hljs-string">&#x27;something&#x27;</span>    # same <span class="hljs-keyword">as</span> `file: <span class="hljs-string">&#x27;my/something&#x27;</span>`
                              # Renders the <span class="hljs-keyword">template</span> <span class="hljs-keyword">only</span>, does <span class="hljs-keyword">not</span> <span class="hljs-keyword">execute</span>
                              # the action

render <span class="hljs-type">json</span>: <span class="hljs-keyword">object</span>
render <span class="hljs-type">xml</span>: <span class="hljs-keyword">object</span>

render <span class="hljs-keyword">location</span>: photo_url(photo)
</code></pre>
<h3 id="head-only-responses">Head-only responses</h3>

<pre><code>head <span class="hljs-symbol">:bad_request</span>
head <span class="hljs-symbol">:created</span>, <span class="hljs-symbol">location:</span> photo_path(<span class="hljs-variable">@photo</span>)
</code></pre>
<h2 id="layouts">Layouts</h2>

<pre><code><span class="hljs-comment"># app/views/layouts/application.html.erb</span>
&lt;%= content_for?(<span class="hljs-symbol">:content</span>) ? <span class="hljs-keyword">yield</span> <span class="hljs-symbol">:content</span> : <span class="hljs-keyword">yield</span> %&gt;

<span class="hljs-comment"># app/views/layouts/news.html.erb</span>
&lt;% content_for <span class="hljs-symbol">:content</span> <span class="hljs-keyword">do</span> %&gt;
   ...
&lt;% <span class="hljs-keyword">end</span> %&gt;
&lt;% render <span class="hljs-symbol">template:</span> <span class="hljs-symbol">:<span class="hljs-string">&#x27;layouts/application&#x27;</span></span> %&gt;
</code></pre>

</div>
</body>  
</html>