<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>ExUnit cheatsheet</title>
  <link href="s/main.css" rel="stylesheet" />
  <script src="s/main.js"></script>
</head>

<body onload="start()">
  <div class="breadcrumbs"><a href="/">Home</a> / <a href="index.html">cheatsheets</a> / ExUnit cheatsheet</div>
  <div class="edit">
      <a href="https://github.com/kjk/blog/blob/master/www/cheatsheets/devhints\exunit.md" >edit</a>
  </div>
  <div class="toc">
<b>Main</b>: <a href="#test-cases">Test cases</a>, <a href="#capture-io">Capture IO</a>, <a href="#capture-logs">Capture logs</a>, <a href="#async">Async</a>, <a href="#assertions">Assertions</a><br>
<b>Setup</b>: <a href="#pattern-matching">Pattern matching</a>, <a href="#setup">Setup</a><br>
<a href="#also-see">Also see</a><br></div>


  <div id="start"></div>
  <div id="wrapped-content"></div>
<div id="content">
<h3 id="test-cases">Test cases</h3>

<pre><code class="elixir"><span class="hljs-class"><span class="hljs-keyword">defmodule</span> <span class="hljs-title">MyTest</span></span> <span class="hljs-keyword">do</span>
  <span class="hljs-keyword">use</span> ExUnit.Case
  <span class="hljs-keyword">use</span> ExUnit.Case, <span class="hljs-symbol">async:</span> <span class="hljs-keyword">true</span>  <span class="hljs-comment"># for async</span>

  test <span class="hljs-string">&quot;the truth&quot;</span> <span class="hljs-keyword">do</span>
    assert <span class="hljs-number">1</span> + <span class="hljs-number">1</span> == <span class="hljs-number">2</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h3 id="capture-io">Capture IO</h3>

<pre><code class="elixir"><span class="hljs-keyword">import</span> ExUnit.CaptureIO

test <span class="hljs-string">&quot;capture io&quot;</span> <span class="hljs-keyword">do</span>
  result = capture_io(<span class="hljs-keyword">fn</span> -&gt;
    IO.puts <span class="hljs-string">&quot;sup&quot;</span>
  <span class="hljs-keyword">end</span>)

  assert result == <span class="hljs-string">&quot;sup\n&quot;</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h3 id="capture-logs">Capture logs</h3>

<pre><code class="elixir">config <span class="hljs-symbol">:ex_unit</span>, <span class="hljs-symbol">capture_logs:</span> <span class="hljs-keyword">true</span>
</code></pre>
<h3 id="async">Async</h3>

<pre><code class="elixir"><span class="hljs-class"><span class="hljs-keyword">defmodule</span> <span class="hljs-title">AssertionTest</span></span> <span class="hljs-keyword">do</span>
  <span class="hljs-comment"># run concurrently with other test cases</span>
  <span class="hljs-keyword">use</span> ExUnit.Case, <span class="hljs-symbol">async:</span> <span class="hljs-keyword">true</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h3 id="assertions">Assertions</h3>

<pre><code class="elixir">assert x == y
refute x == y

assert_raise ArithmeticError, <span class="hljs-keyword">fn</span> -&gt;
  <span class="hljs-number">1</span> + <span class="hljs-string">&quot;test&quot;</span>
<span class="hljs-keyword">end</span>

assert_raise ArithmeticError, <span class="hljs-string">&quot;message&quot;</span>, <span class="hljs-keyword">fn</span> -&gt; ...
assert_raise ArithmeticError, <span class="hljs-string">~r/message/</span>, <span class="hljs-keyword">fn</span> -&gt; ...

flunk <span class="hljs-string">&quot;This should&#x27;ve been an error&quot;</span>
</code></pre>
<p>See: <a href="http://devdocs.io/elixir/ex_unit/exunit.assertions">Assertions</a></p>
<h2 id="setup">Setup</h2>
<h3 id="pattern-matching">Pattern matching</h3>

<pre><code class="elixir">setup <span class="hljs-keyword">do</span>

<span class="hljs-keyword">end</span>
</code></pre>

<pre><code class="elixir">test <span class="hljs-string">&quot;it works&quot;</span>, %{<span class="hljs-symbol">name:</span> name} <span class="hljs-keyword">do</span>
  assert name == <span class="hljs-string">&quot;John&quot;</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h3 id="setup">Setup</h3>

<pre><code class="elixir"><span class="hljs-function"><span class="hljs-keyword">defp</span> <span class="hljs-title">my_hook</span></span>(_context) <span class="hljs-keyword">do</span>
  <span class="hljs-comment"># Invoked in every block in &quot;a block&quot;</span>

<span class="hljs-keyword">end</span>

describe <span class="hljs-string">&quot;a block&quot;</span> <span class="hljs-keyword">do</span>
  setup [<span class="hljs-symbol">:my_hook</span>]

  test <span class="hljs-string">&quot;John&#x27;s age&quot;</span>, context <span class="hljs-keyword">do</span>
    assert context[<span class="hljs-symbol">:name</span>] == <span class="hljs-string">&quot;John&quot;</span>
    assert context[<span class="hljs-symbol">:age</span>] == <span class="hljs-number">54</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h2 id="also-see">Also see</h2>

<ul>
<li><a href="http://devdocs.io/elixir/ex_unit/exunit#configure/1">ExUnit Docs</a></li>
</ul>

</div>
</body>  
</html>