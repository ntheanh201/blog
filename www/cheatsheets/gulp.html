<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Gulp cheatsheet</title>
  <link href="s/main.css" rel="stylesheet" />
  <script src="s/main.js"></script>
</head>

<body onload="start()">
  <div class="breadcrumbs"><a href="/">Home</a> / <a href="index.html">cheatsheets</a> / Gulp cheatsheet</div>
  <div class="edit">
      <a href="https://github.com/kjk/blog/blob/master/www/cheatsheets/devhints\gulp.md" >edit</a>
  </div>
  <div class="toc">
<b>Main</b>: <a href="#example">Example</a>, <a href="#references">References</a>, <a href="#livereload">Livereload</a><br></div>


  <div id="start"></div>
  <div id="wrapped-content"></div>
<div id="content">

<ul>
<li>gulp-ruby-sass</li>
<li>gulp-autoprefixer</li>
<li>gulp-minify-css</li>
<li>gulp-jshint</li>
<li>gulp-concat</li>
<li>gulp-uglify</li>
<li>gulp-imagemin</li>
<li>gulp-livereload (requires tiny-lr)</li>
<li>gulp-clean</li>
<li>gulp-cache</li>
<li><p>gulp-notify</p>
</li>
<li><p>gulp-header (headers in files)</p>
</li>
<li>gulp-mocha</li>
<li>gulp-stylus</li>
<li>gulp-compass</li>
<li>gulp-nodemon</li>
<li>gulp-size (displays size)</li>
</ul>
<h3 id="example">Example</h3>

<pre><code><span class="hljs-comment">// gulpfile.js</span>
<span class="hljs-comment">// Load plugins</span>
<span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;gulp&#x27;</span>),
    sass = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;gulp-ruby-sass&#x27;</span>),
    autoprefixer = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;gulp-autoprefixer&#x27;</span>),
    minifycss = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;gulp-minify-css&#x27;</span>),
    jshint = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;gulp-jshint&#x27;</span>),
    uglify = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;gulp-uglify&#x27;</span>),
    imagemin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;gulp-imagemin&#x27;</span>),
    rename = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;gulp-rename&#x27;</span>),
    clean = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;gulp-clean&#x27;</span>),
    concat = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;gulp-concat&#x27;</span>),
    notify = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;gulp-notify&#x27;</span>),
    cache = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;gulp-cache&#x27;</span>),
    livereload = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;gulp-livereload&#x27;</span>),
    lr = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;tiny-lr&#x27;</span>),
    server = <span class="hljs-title function_">lr</span>();

<span class="hljs-comment">// Styles</span>
gulp.<span class="hljs-title function_">task</span>(<span class="hljs-string">&#x27;styles&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">return</span> gulp.<span class="hljs-title function_">src</span>(<span class="hljs-string">&#x27;src/styles/main.scss&#x27;</span>)
    .<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">sass</span>({ <span class="hljs-attr">style</span>: <span class="hljs-string">&#x27;expanded&#x27;</span>, }))
    .<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">autoprefixer</span>(<span class="hljs-string">&#x27;last 2 version&#x27;</span>, <span class="hljs-string">&#x27;safari 5&#x27;</span>, <span class="hljs-string">&#x27;ie 8&#x27;</span>, <span class="hljs-string">&#x27;ie 9&#x27;</span>, <span class="hljs-string">&#x27;opera 12.1&#x27;</span>, <span class="hljs-string">&#x27;ios 6&#x27;</span>, <span class="hljs-string">&#x27;android 4&#x27;</span>))
    .<span class="hljs-title function_">pipe</span>(gulp.<span class="hljs-title function_">dest</span>(<span class="hljs-string">&#x27;dist/styles&#x27;</span>))
    .<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">rename</span>({ <span class="hljs-attr">suffix</span>: <span class="hljs-string">&#x27;.min&#x27;</span> }))
    .<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">minifycss</span>())
    .<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">livereload</span>(server))
    .<span class="hljs-title function_">pipe</span>(gulp.<span class="hljs-title function_">dest</span>(<span class="hljs-string">&#x27;dist/styles&#x27;</span>))
    .<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">notify</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;Styles task complete&#x27;</span> }));
});

<span class="hljs-comment">// Scripts</span>
gulp.<span class="hljs-title function_">task</span>(<span class="hljs-string">&#x27;scripts&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">return</span> gulp.<span class="hljs-title function_">src</span>(<span class="hljs-string">&#x27;src/scripts/**/*.js&#x27;</span>)
    .<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">jshint</span>(<span class="hljs-string">&#x27;.jshintrc&#x27;</span>))
    .<span class="hljs-title function_">pipe</span>(jshint.<span class="hljs-title function_">reporter</span>(<span class="hljs-string">&#x27;default&#x27;</span>))
    .<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">concat</span>(<span class="hljs-string">&#x27;main.js&#x27;</span>))
    .<span class="hljs-title function_">pipe</span>(gulp.<span class="hljs-title function_">dest</span>(<span class="hljs-string">&#x27;dist/scripts&#x27;</span>))
    .<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">rename</span>({ <span class="hljs-attr">suffix</span>: <span class="hljs-string">&#x27;.min&#x27;</span> }))
    .<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">uglify</span>())
    .<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">livereload</span>(server))
    .<span class="hljs-title function_">pipe</span>(gulp.<span class="hljs-title function_">dest</span>(<span class="hljs-string">&#x27;dist/scripts&#x27;</span>))
    .<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">notify</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;Scripts task complete&#x27;</span> }));
});

<span class="hljs-comment">// Images</span>
gulp.<span class="hljs-title function_">task</span>(<span class="hljs-string">&#x27;images&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">return</span> gulp.<span class="hljs-title function_">src</span>(<span class="hljs-string">&#x27;src/images/**/*&#x27;</span>)
    .<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">cache</span>(<span class="hljs-title function_">imagemin</span>({ <span class="hljs-attr">optimizationLevel</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">progressive</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">interlaced</span>: <span class="hljs-literal">true</span> })))
    .<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">livereload</span>(server))
    .<span class="hljs-title function_">pipe</span>(gulp.<span class="hljs-title function_">dest</span>(<span class="hljs-string">&#x27;dist/images&#x27;</span>))
    .<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">notify</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;Images task complete&#x27;</span> }));
});

<span class="hljs-comment">// Clean</span>
gulp.<span class="hljs-title function_">task</span>(<span class="hljs-string">&#x27;clean&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">return</span> gulp.<span class="hljs-title function_">src</span>([<span class="hljs-string">&#x27;dist/styles&#x27;</span>, <span class="hljs-string">&#x27;dist/scripts&#x27;</span>, <span class="hljs-string">&#x27;dist/images&#x27;</span>], {<span class="hljs-attr">read</span>: <span class="hljs-literal">false</span>})
    .<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">clean</span>());
});

<span class="hljs-comment">// Default task</span>
gulp.<span class="hljs-title function_">task</span>(<span class="hljs-string">&#x27;default&#x27;</span>, [<span class="hljs-string">&#x27;clean&#x27;</span>], <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
    gulp.<span class="hljs-title function_">start</span>(<span class="hljs-string">&#x27;styles&#x27;</span>, <span class="hljs-string">&#x27;scripts&#x27;</span>, <span class="hljs-string">&#x27;images&#x27;</span>);
});

<span class="hljs-comment">// Watch</span>
gulp.<span class="hljs-title function_">task</span>(<span class="hljs-string">&#x27;watch&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {

  <span class="hljs-comment">// Listen on port 35729</span>
  server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">35729</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) {
    <span class="hljs-keyword">if</span> (err) {
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err)
    };

    <span class="hljs-comment">// Watch .scss files</span>
    gulp.<span class="hljs-title function_">watch</span>(<span class="hljs-string">&#x27;src/styles/**/*.scss&#x27;</span>, [<span class="hljs-string">&#x27;styles&#x27;</span>]);

    <span class="hljs-comment">// Watch .js files</span>
    gulp.<span class="hljs-title function_">watch</span>(<span class="hljs-string">&#x27;src/scripts/**/*.js&#x27;</span>, [<span class="hljs-string">&#x27;scripts&#x27;</span>]);

    <span class="hljs-comment">// Watch image files</span>
    gulp.<span class="hljs-title function_">watch</span>(<span class="hljs-string">&#x27;src/images/**/*&#x27;</span>, [<span class="hljs-string">&#x27;images&#x27;</span>]);

  });

});
</code></pre>
<h3 id="references">References</h3>
<p><a href="https://github.com/gulpjs/gulp/blob/master/docs/getting-started.md#getting-started">https://github.com/gulpjs/gulp/blob/master/docs/getting-started.md#getting-started</a></p>
<h3 id="livereload">Livereload</h3>

<pre><code><span class="hljs-keyword">var</span> lr = <span class="hljs-keyword">require</span>(<span class="hljs-string">&#x27;tiny-lr&#x27;</span>)();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">notify</span> (<span class="hljs-params">lr, root</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
    <span class="hljs-keyword">var</span> fname = <span class="hljs-keyword">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>).relative(root, event.path);
    lr.changed({ body: { files: [ fname ] }});
  };
}

gulp.task(<span class="hljs-string">&#x27;livereload&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  lr.listen(<span class="hljs-number">35729</span>)
  gulp.watch(<span class="hljs-string">&#x27;public/**/*&#x27;</span>, notify(lr, __dirname+<span class="hljs-string">&#x27;/public&#x27;</span>));
});

<span class="hljs-comment">// Express</span>
app.<span class="hljs-keyword">use</span>(<span class="hljs-keyword">require</span>(<span class="hljs-string">&#x27;connect-livereload&#x27;</span>)())
&lt;!-- livereload --&gt;&lt;script&gt;document.write(<span class="hljs-string">&#x27;&lt;script src=&quot;&#x27;</span>+(location.protocol||<span class="hljs-string">&#x27;http:&#x27;</span>)+<span class="hljs-string">&#x27;//&#x27;</span>+(location.hostname||<span class="hljs-string">&#x27;localhost&#x27;</span>)+<span class="hljs-string">&#x27;:35729/livereload.js?snipver=1&quot;&gt;&lt;\/scr&#x27;</span>+<span class="hljs-string">&#x27;ipt&gt;&#x27;</span>)&lt;/script&gt;
</code></pre>

</div>
</body>  
</html>