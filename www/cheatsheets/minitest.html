<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Minitest cheatsheet</title>
  <link href="s/main.css" rel="stylesheet" />
  <script src="s/main.js"></script>
</head>

<body onload="start()">
  <div class="breadcrumbs"><a href="/">Home</a> / <a href="index.html">cheatsheets</a> / Minitest cheatsheet</div>
  <div class="edit">
      <a href="https://github.com/kjk/blog/blob/master/www/cheatsheets/devhints/minitest.md" >edit</a>
  </div>
  <div class="toc">
<b>Main</b>: <a href="#usage">Usage</a>, <a href="#specs-must-wont-">Specs (.must/.wont)</a>, <a href="#test">Test</a>, <a href="#assertions">Assertions</a>, <a href="#minitest-mock">Minitest::Mock</a>, <a href="#reporters">Reporters</a><br></div>


  <div id="start"></div>
  <div id="wrapped-content"></div>
<div id="content">
<h3 id="usage">Usage</h3>

<pre><code>require <span class="hljs-string">&#x27;minitest/autorun&#x27;</span>

describe &quot;X&quot; <span class="hljs-keyword">do</span>
  <span class="hljs-keyword">before</span> <span class="hljs-keyword">do</span> .. <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">after</span> <span class="hljs-keyword">do</span> .. <span class="hljs-keyword">end</span>
  subject { .. }
  let(:list) { <span class="hljs-keyword">Array</span>.<span class="hljs-built_in">new</span> }

  it &quot;should work&quot; <span class="hljs-keyword">do</span>
    <span class="hljs-keyword">assert</span> <span class="hljs-keyword">true</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h3 id="specs-must-wont-">Specs (.must/.wont)</h3>

<pre><code><span class="hljs-function"><span class="hljs-title">expect</span><span class="hljs-params">(x)</span></span>
<span class="hljs-selector-class">.must_be</span> :==, <span class="hljs-number">0</span>
<span class="hljs-selector-class">.must_equal</span> <span class="hljs-selector-tag">b</span>
<span class="hljs-selector-class">.must_be_close_to</span> <span class="hljs-number">2.99999</span>
<span class="hljs-selector-class">.must_be_same_as</span> <span class="hljs-selector-tag">b</span>

<span class="hljs-selector-class">.must_include</span> needle
<span class="hljs-selector-class">.must_be_empty</span>

<span class="hljs-selector-class">.must_be_kind_of</span>
<span class="hljs-selector-class">.must_be_instance_of</span>
<span class="hljs-selector-class">.must_be_nil</span>
<span class="hljs-selector-class">.must_match</span> /regex/
<span class="hljs-selector-class">.must_be</span> :&lt;=, <span class="hljs-number">42</span>
<span class="hljs-selector-class">.must_respond_to</span> msg

<span class="hljs-selector-class">.must_be_silent</span>  ( proc { <span class="hljs-string">&quot;no stdout or stderr&quot;</span> }.must_be_silent)
<span class="hljs-selector-class">.must_output</span> <span class="hljs-string">&quot;hi&quot;</span>

proc { ... }<span class="hljs-selector-class">.must_output</span> out_or_nil <span class="hljs-selector-attr">[, err]</span>
proc { ... }<span class="hljs-selector-class">.must_raise</span> exception
proc { ... }<span class="hljs-selector-class">.must_throw</span> sym
</code></pre>
<h3 id="test">Test</h3>

<pre><code><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestHipster</span> &lt; Minitest::Test</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">setup</span></span>
    <span class="hljs-variable">@subject</span> = [<span class="hljs-string">&quot;silly hats&quot;</span>, <span class="hljs-string">&quot;skinny jeans&quot;</span>]
  <span class="hljs-keyword">end</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">teardown</span></span>
    <span class="hljs-variable">@hipster</span>.destroy!
  <span class="hljs-keyword">end</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_for_helvetica_font</span></span>
    assert_equal <span class="hljs-string">&quot;helvetica!&quot;</span>, <span class="hljs-variable">@hipster</span>.preferred_font
  <span class="hljs-keyword">end</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_not_mainstream</span></span>
    refute <span class="hljs-variable">@hipster</span>.mainstream?
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h3 id="assertions">Assertions</h3>

<pre><code><span class="hljs-keyword">assert</span>
<span class="hljs-keyword">assert</span><span class="hljs-number">_</span>block { ... }
<span class="hljs-keyword">assert</span><span class="hljs-number">_</span>empty
<span class="hljs-keyword">assert</span><span class="hljs-number">_</span>equal <span class="hljs-number">2</span>, <span class="hljs-meta">@size</span>
<span class="hljs-keyword">assert</span><span class="hljs-number">_</span><span class="hljs-keyword">in</span><span class="hljs-number">_</span>delta <span class="hljs-meta">@size</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>
<span class="hljs-keyword">assert</span><span class="hljs-number">_</span><span class="hljs-keyword">in</span><span class="hljs-number">_</span>epsilon
<span class="hljs-keyword">assert</span><span class="hljs-number">_</span>includes <span class="hljs-meta">@list</span>, <span class="hljs-string">&quot;item&quot;</span>
<span class="hljs-keyword">assert</span><span class="hljs-number">_</span>instance<span class="hljs-number">_</span><span class="hljs-keyword">of</span> Array, <span class="hljs-meta">@list</span>
<span class="hljs-keyword">assert</span><span class="hljs-number">_k</span>ind<span class="hljs-number">_</span><span class="hljs-keyword">of</span> Enumerable, <span class="hljs-meta">@list</span>
<span class="hljs-keyword">assert</span><span class="hljs-number">_m</span>atch <span class="hljs-meta">@str</span>, /regex/
<span class="hljs-keyword">assert</span><span class="hljs-number">_n</span>il
<span class="hljs-keyword">assert</span><span class="hljs-number">_</span>operator <span class="hljs-meta">@n</span>, :==, <span class="hljs-number">0</span>
<span class="hljs-keyword">assert</span><span class="hljs-number">_</span>output
<span class="hljs-keyword">assert</span><span class="hljs-number">_</span>raises
<span class="hljs-keyword">assert</span><span class="hljs-number">_</span>respond<span class="hljs-number">_</span>to
<span class="hljs-keyword">assert</span><span class="hljs-number">_</span>same
<span class="hljs-keyword">assert</span><span class="hljs-number">_</span>send
<span class="hljs-keyword">assert</span><span class="hljs-number">_</span>silent
<span class="hljs-keyword">assert</span><span class="hljs-number">_</span><span class="hljs-meta">throws</span>
</code></pre>
<h3 id="minitest-mock">Minitest::Mock</h3>
<p>A simple and clean mock system. There two essential methods at our disposal: expect and verify.</p>

<pre><code><span class="hljs-keyword">require</span> <span class="hljs-string">&#x27;minitest/autorun&#x27;</span>

describe Twipster, <span class="hljs-string">&quot;Make every tweet a hipster tweet.&quot;</span> <span class="hljs-keyword">do</span>
  before <span class="hljs-keyword">do</span>
    <span class="hljs-variable">@twitter</span>  = Minitest::Mock.new
    <span class="hljs-variable">@twipster</span> = Twipster.new(<span class="hljs-variable">@twitter</span>)
  <span class="hljs-keyword">end</span>

  it <span class="hljs-string">&quot;should append a #lolhipster hashtag and update Twitter with our status&quot;</span> <span class="hljs-keyword">do</span>
    tweet = <span class="hljs-string">&quot;Skyrim? Too mainstream.&quot;</span>
    <span class="hljs-variable">@twitter</span>.expect <span class="hljs-symbol">:update</span>, <span class="hljs-literal">true</span>, [<span class="hljs-string">&quot;<span class="hljs-subst">#{tweet}</span> #lolhipster&quot;</span>]
    <span class="hljs-variable">@twipster</span>.submit(tweet)
    assert <span class="hljs-variable">@twitter</span>.verify <span class="hljs-comment"># verifies tweet and hashtag was passed to `<span class="hljs-doctag">@twitter</span>.update`</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h3 id="reporters">Reporters</h3>

<pre><code>gem <span class="hljs-string">&#x27;minitest-reporters&#x27;</span>

<span class="hljs-keyword">require</span> <span class="hljs-string">&#x27;minitest/reporters&#x27;</span>
Minitest::Reporters.<span class="hljs-keyword">use</span>! Minitest::Reporters::SpecReporter.<span class="hljs-keyword">new</span>

[<span class="hljs-keyword">Default</span>, Spec, Progress, RubyMate, RubyMine, JUnit]
</code></pre>

</div>
</body>  
</html>