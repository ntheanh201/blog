<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Ansible modules cheatsheet</title>
  <link href="s/main.css" rel="stylesheet" />
  <script src="s/main.js"></script>
</head>

<body onload="start()">
  <div class="breadcrumbs"><a href="/">Home</a> / <a href="index.html">cheatsheets</a> / Ansible modules cheatsheet</div>
  <div class="edit">
      <a href="https://github.com/kjk/blog/blob/master/www/cheatsheets/devhints/ansible-modules.md" >edit</a>
  </div>
  <div class="toc">
<b>Format</b>: <a href="#basic-file">Basic file</a>, <a href="#task-formats">Task formats</a><br>
<b>Modules</b>: <a href="#aptitude">Aptitude</a>, <a href="#git">git</a>, <a href="#git_config">git_config</a>, <a href="#user">user</a>, <a href="#service">service</a><br>
<b>Shell</b>: <a href="#shell1">shell</a>, <a href="#script">script</a><br>
<b>Files</b>: <a href="#file">file</a>, <a href="#copy">copy</a>, <a href="#template">template</a><br>
<b>Local actions</b>: <a href="#local_action">local_action</a>, <a href="#debug">debug</a><br></div>


  <div id="start"></div>
  <div id="wrapped-content"></div>
<div id="content">
<h2 id="format">Format</h2>
<h3 id="basic-file">Basic file</h3>

<pre><code class="yaml"><span class="hljs-meta">---</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">hosts:</span> <span class="hljs-string">production</span>
  <span class="hljs-attr">remote_user:</span> <span class="hljs-string">root</span>
  <span class="hljs-attr">tasks:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">···</span>
</code></pre>
<p>Place your modules inside <code>tasks</code>.</p>
<h3 id="task-formats">Task formats</h3>
<h4 id="one-line">One-line</h4>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">apt:</span> <span class="hljs-string">pkg=vim</span> <span class="hljs-string">state=present</span>
</code></pre>
<h4 id="map">Map</h4>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">apt:</span>
    <span class="hljs-attr">pkg:</span> <span class="hljs-string">vim</span>
    <span class="hljs-attr">state:</span> <span class="hljs-string">present</span>
</code></pre>
<h4 id="foldable-scalar">Foldable scalar</h4>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">apt:</span> <span class="hljs-string">&gt;
    pkg=vim
    state=present</span>
</code></pre>
<p>Define your tasks in any of these formats. One-line format is preferred for short declarations, while maps are preferred for longer.</p>
<h2 id="modules">Modules</h2>
<h3 id="aptitude">Aptitude</h3>
<h4 id="packages">Packages</h4>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">apt:</span>
    <span class="hljs-attr">pkg:</span> <span class="hljs-string">nodejs</span>
    <span class="hljs-attr">state:</span> <span class="hljs-string">present</span> <span class="hljs-comment"># absent | latest</span>
    <span class="hljs-attr">update_cache:</span> <span class="hljs-literal">yes</span>
    <span class="hljs-attr">force:</span> <span class="hljs-literal">no</span>
</code></pre>
<h4 id="deb-files">Deb files</h4>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">apt:</span>
    <span class="hljs-attr">deb:</span> <span class="hljs-string">&quot;https://packages.erlang-solutions.com/erlang-solutions_1.0_all.deb&quot;</span>
</code></pre>
<h4 id="repositories">Repositories</h4>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">apt_repository:</span>
    <span class="hljs-attr">repo:</span> <span class="hljs-string">&quot;deb https://··· raring main&quot;</span>
    <span class="hljs-attr">state:</span> <span class="hljs-string">present</span>
</code></pre>
<h4 id="repository-keys">Repository keys</h4>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">apt_key:</span>
    <span class="hljs-attr">id:</span> <span class="hljs-string">AC40B2F7</span>
    <span class="hljs-attr">url:</span> <span class="hljs-string">&quot;http://···&quot;</span>
    <span class="hljs-attr">state:</span> <span class="hljs-string">present</span>
</code></pre>
<h3 id="git">git</h3>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">git:</span>
    <span class="hljs-attr">repo:</span> <span class="hljs-string">git://github.com/</span>
    <span class="hljs-attr">dest:</span> <span class="hljs-string">/srv/checkout</span>
    <span class="hljs-attr">version:</span> <span class="hljs-string">master</span>
    <span class="hljs-attr">depth:</span> <span class="hljs-number">10</span>
    <span class="hljs-attr">bare:</span> <span class="hljs-literal">yes</span>
</code></pre>
<p>See: <a href="http://devdocs.io/ansible/git_module">git module</a></p>
<h3 id="git_config">git_config</h3>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">git_config:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">user.email</span>
    <span class="hljs-attr">scope:</span> <span class="hljs-string">global</span> <span class="hljs-comment"># local | system</span>
    <span class="hljs-attr">value:</span> <span class="hljs-string">hi@example.com</span>
</code></pre>
<p>See: <a href="http://devdocs.io/ansible/git_config_module">git_config module</a></p>
<h3 id="user">user</h3>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">user:</span>
    <span class="hljs-attr">state:</span> <span class="hljs-string">present</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">git</span>
    <span class="hljs-attr">system:</span> <span class="hljs-literal">yes</span>
    <span class="hljs-attr">shell:</span> <span class="hljs-string">/bin/sh</span>
    <span class="hljs-attr">groups:</span> <span class="hljs-string">admin</span>
    <span class="hljs-attr">comment:</span> <span class="hljs-string">&quot;Git Version Control&quot;</span>
</code></pre>
<p>See: <a href="http://devdocs.io/ansible/user_module">user module</a></p>
<h3 id="service">service</h3>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">service:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">nginx</span>
    <span class="hljs-attr">state:</span> <span class="hljs-string">started</span>
    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">yes</span>     <span class="hljs-comment"># optional</span>
</code></pre>
<p>See: <a href="http://devdocs.io/ansible/service_module">service module</a></p>
<h2 id="shell">Shell</h2>
<h3 id="shell1">shell</h3>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">shell:</span> <span class="hljs-string">apt-get</span> <span class="hljs-string">install</span> <span class="hljs-string">nginx</span> <span class="hljs-string">-y</span>
</code></pre>
<h4 id="extra-options">Extra options</h4>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">shell:</span> <span class="hljs-string">echo</span> <span class="hljs-string">hello</span>
  <span class="hljs-attr">args:</span>
    <span class="hljs-attr">creates:</span> <span class="hljs-string">/path/file</span>  <span class="hljs-comment"># skip if this exists</span>
    <span class="hljs-attr">removes:</span> <span class="hljs-string">/path/file</span>  <span class="hljs-comment"># skip if this is missing</span>
    <span class="hljs-attr">chdir:</span> <span class="hljs-string">/path</span>         <span class="hljs-comment"># cd here before running</span>
</code></pre>
<h4 id="multiline-example">Multiline example</h4>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">shell:</span> <span class="hljs-string">|
    echo &quot;hello there&quot;
    echo &quot;multiple lines&quot;</span>
</code></pre>
<p>See: <a href="http://devdocs.io/ansible/shell_module">shell module</a></p>
<h3 id="script">script</h3>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">script:</span> <span class="hljs-string">/x/y/script.sh</span>
  <span class="hljs-attr">args:</span>
    <span class="hljs-attr">creates:</span> <span class="hljs-string">/path/file</span>  <span class="hljs-comment"># skip if this exists</span>
    <span class="hljs-attr">removes:</span> <span class="hljs-string">/path/file</span>  <span class="hljs-comment"># skip if this is missing</span>
    <span class="hljs-attr">chdir:</span> <span class="hljs-string">/path</span>         <span class="hljs-comment"># cd here before running</span>
</code></pre>
<p>See: <a href="http://devdocs.io/ansible/script_module">script module</a></p>
<h2 id="files">Files</h2>
<h3 id="file">file</h3>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">file:</span>
    <span class="hljs-attr">path:</span> <span class="hljs-string">/etc/dir</span>
    <span class="hljs-attr">state:</span> <span class="hljs-string">directory</span> <span class="hljs-comment"># file | link | hard | touch | absent</span>

    <span class="hljs-comment"># Optional:</span>
    <span class="hljs-attr">owner:</span> <span class="hljs-string">bin</span>
    <span class="hljs-attr">group:</span> <span class="hljs-string">wheel</span>
    <span class="hljs-attr">mode:</span> <span class="hljs-number">0644</span>
    <span class="hljs-attr">recurse:</span> <span class="hljs-literal">yes</span>  <span class="hljs-comment"># mkdir -p</span>
    <span class="hljs-attr">force:</span> <span class="hljs-literal">yes</span>    <span class="hljs-comment"># ln -nfs</span>
</code></pre>
<p>See: <a href="http://devdocs.io/ansible/file_module">file module</a></p>
<h3 id="copy">copy</h3>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">copy:</span>
    <span class="hljs-attr">src:</span> <span class="hljs-string">/app/config/nginx.conf</span>
    <span class="hljs-attr">dest:</span> <span class="hljs-string">/etc/nginx/nginx.conf</span>

    <span class="hljs-comment"># Optional:</span>
    <span class="hljs-attr">owner:</span> <span class="hljs-string">user</span>
    <span class="hljs-attr">group:</span> <span class="hljs-string">user</span>
    <span class="hljs-attr">mode:</span> <span class="hljs-number">0644</span>
    <span class="hljs-attr">backup:</span> <span class="hljs-literal">yes</span>
</code></pre>
<p>See: <a href="http://devdocs.io/ansible/copy_module">copy module</a></p>
<h3 id="template">template</h3>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">template:</span>
    <span class="hljs-attr">src:</span> <span class="hljs-string">config/redis.j2</span>
    <span class="hljs-attr">dest:</span> <span class="hljs-string">/etc/redis.conf</span>

    <span class="hljs-comment"># Optional:</span>
    <span class="hljs-attr">owner:</span> <span class="hljs-string">user</span>
    <span class="hljs-attr">group:</span> <span class="hljs-string">user</span>
    <span class="hljs-attr">mode:</span> <span class="hljs-number">0644</span>
    <span class="hljs-attr">backup:</span> <span class="hljs-literal">yes</span>
</code></pre>
<p>See: <a href="http://devdocs.io/ansible/template_module">template module</a></p>
<h2 id="local-actions">Local actions</h2>
<h3 id="local_action">local_action</h3>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">do</span> <span class="hljs-string">something</span> <span class="hljs-string">locally</span>
  <span class="hljs-attr">local_action:</span> <span class="hljs-string">shell</span> <span class="hljs-string">echo</span> <span class="hljs-string">hello</span>
</code></pre>
<h3 id="debug">debug</h3>

<pre><code class="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">debug:</span>
    <span class="hljs-attr">msg:</span> <span class="hljs-string">&quot;Hello <span class="hljs-template-variable">{{ var }}</span>&quot;</span>
</code></pre>
<p>See: <a href="http://devdocs.io/ansible/debug_module">debug module</a></p>

</div>
</body>  
</html>