<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Routes cheatsheet</title>
  <link href="s/main.css" rel="stylesheet" />
  <script src="s/main.js"></script>
</head>

<body onload="start()">
  <div class="breadcrumbs"><a href="/">Home</a> / <a href="index.html">cheatsheets</a> / Routes cheatsheet</div>
  <div class="edit">
      <a href="https://github.com/kjk/blog/blob/master/www/cheatsheets/devhints\rails-routes.md" >edit</a>
  </div>
  <div class="toc">
<b>Multiple resources (resources)</b>: <a href="#custom-actions">Custom actions</a>, <a href="#options">Options</a><br>
<a href="#single-resource-resource-">Single resource (resource)</a><br>
<b>Matching (match)</b>: <a href="#get-post">Get/post</a>, <a href="#redirection">Redirection</a>, <a href="#named">Named</a>, <a href="#constraints">Constraints</a>, <a href="#custom-constraints">Custom constraints</a>, <a href="#scopes">Scopes</a>, <a href="#rack-middleware">Rack middleware</a>, <a href="#route-helpers">Route helpers</a>, <a href="#default-help-text">Default help text</a>, <a href="#references">References</a><br></div>


  <div id="start"></div>
  <div id="wrapped-content"></div>
<div id="content">
<h2 id="multiple-resources-resources-">Multiple resources (<code>resources</code>)</h2>

<pre><code>resources :photos

# PhotosController:
# index  =&gt;    GET /photos
# <span class="hljs-keyword">new</span>    =&gt;    GET <span class="hljs-regexp">/photos/</span><span class="hljs-keyword">new</span>
# create =&gt;   POST <span class="hljs-regexp">/photos/</span><span class="hljs-keyword">new</span>
# show   =&gt;    GET <span class="hljs-regexp">/photos/</span>:id
# edit   =&gt;    GET <span class="hljs-regexp">/photos/</span>:id/edit
# update =&gt;    PUT <span class="hljs-regexp">/photos/</span>:id
# <span class="hljs-keyword">delete</span> =&gt; <span class="hljs-keyword">DELETE</span> <span class="hljs-regexp">/photos/</span>:id
#
# Helpers:
# new_photo_path
# photo_path(id)
# edit_photo_path(id)
</code></pre>
<h3 id="custom-actions">Custom actions</h3>

<pre><code>resources :photos <span class="hljs-keyword">do</span>
  member { <span class="hljs-keyword">get</span> <span class="hljs-string">&#x27;preview&#x27;</span> }       <span class="hljs-meta"># /photo/1/preview</span>
  collection { <span class="hljs-keyword">get</span> <span class="hljs-string">&#x27;search&#x27;</span> }    <span class="hljs-meta"># /photos/search</span>

  <span class="hljs-keyword">get</span> <span class="hljs-string">&#x27;preview&#x27;</span>, <span class="hljs-keyword">on</span>: :member     <span class="hljs-meta"># (..same as the first)</span>
end
</code></pre>
<h3 id="options">Options</h3>

<pre><code>resources :photos,
  path_names: { <span class="hljs-built_in">new</span>: <span class="hljs-string">&#x27;brand_new&#x27;</span> }    # /photos/<span class="hljs-number">1</span>/brand_new
  <span class="hljs-type">path</span>: <span class="hljs-string">&#x27;postings&#x27;</span>                    # /postings
  <span class="hljs-keyword">only</span>: :<span class="hljs-keyword">index</span>
  <span class="hljs-keyword">only</span>: [:<span class="hljs-keyword">index</span>, :<span class="hljs-keyword">show</span>]
  <span class="hljs-keyword">except</span>: :<span class="hljs-keyword">show</span>
  <span class="hljs-keyword">except</span>: [:<span class="hljs-keyword">index</span>, :<span class="hljs-keyword">show</span>]

  shallow: <span class="hljs-keyword">true</span>                       # <span class="hljs-keyword">also</span> generate shallow routes
  shalow_path: <span class="hljs-string">&#x27;secret&#x27;</span>
  shallow_prefix: <span class="hljs-string">&#x27;secret&#x27;</span>
</code></pre>
<h2 id="single-resource-resource-">Single resource (<code>resource</code>)</h2>

<pre><code>resource :coder

# CodersController:
# <span class="hljs-keyword">new</span>    =&gt;    GET <span class="hljs-regexp">/coder/</span><span class="hljs-keyword">new</span>
# create =&gt;   POST <span class="hljs-regexp">/coder/</span><span class="hljs-keyword">new</span>
# show   =&gt;    GET /coder
# edit   =&gt;    GET <span class="hljs-regexp">/coder/</span>edit
# update =&gt;    PUT /coder
# <span class="hljs-keyword">delete</span> =&gt; <span class="hljs-keyword">DELETE</span> /coder
</code></pre>
<h2 id="matching-match-">Matching (<code>match</code>)</h2>

<pre><code>match <span class="hljs-symbol">&#x27;photo</span>/:id&#x27; =&gt; <span class="hljs-symbol">&#x27;photos</span>#show&#x27;  # /photo/what-is-it
match <span class="hljs-symbol">&#x27;photo</span>/:id&#x27;, id: /[<span class="hljs-number">0</span>-<span class="hljs-number">9</span>]+/     # /photo/<span class="hljs-number">0192</span>
match <span class="hljs-symbol">&#x27;photo</span>/:id&#x27; =&gt; <span class="hljs-symbol">&#x27;photos</span>#show&#x27;, constraints: { id: /[<span class="hljs-number">0</span>-<span class="hljs-number">9</span>]+/ }
match <span class="hljs-symbol">&#x27;photo</span>/:id&#x27;, via: :get
match <span class="hljs-symbol">&#x27;photo</span>/:id&#x27;, via: [:get, :post]

match <span class="hljs-symbol">&#x27;photo</span>/*path&#x27; =&gt; <span class="hljs-symbol">&#x27;photos</span>#unknown&#x27;    # /photo/what/ever

# params[:format] == <span class="hljs-symbol">&#x27;jpg&#x27;</span>
match <span class="hljs-symbol">&#x27;photos</span>/:id&#x27; =&gt; <span class="hljs-symbol">&#x27;photos</span>#show&#x27;, :defaults =&gt; { :format =&gt; <span class="hljs-symbol">&#x27;jpg&#x27;</span> }
</code></pre>
<h3 id="get-post">Get/post</h3>
<p><code>get</code> is the same as <code>match via: :get</code>.</p>

<pre><code>get <span class="hljs-symbol">&#x27;photo</span>/:id&#x27; =&gt; <span class="hljs-symbol">&#x27;photos</span>#show&#x27;
# same <span class="hljs-keyword">as</span> match <span class="hljs-symbol">&#x27;photo</span>/:id&#x27; =&gt; <span class="hljs-symbol">&#x27;photos</span>#show&#x27;, via: :get

post <span class="hljs-symbol">&#x27;photo</span>/:id&#x27; =&gt; <span class="hljs-symbol">&#x27;photos</span>#update&#x27;
# same <span class="hljs-keyword">as</span> match <span class="hljs-symbol">&#x27;photo</span>/:id&#x27; =&gt; <span class="hljs-symbol">&#x27;photos</span>#show&#x27;, via: :post
</code></pre>
<h3 id="redirection">Redirection</h3>

<pre><code><span class="hljs-variable">match</span> <span class="hljs-string">&#x27;/stories&#x27;</span> =&gt; <span class="hljs-function"><span class="hljs-title">redirect</span>(<span class="hljs-string">&#x27;/posts&#x27;</span>)</span>
<span class="hljs-variable">match</span> <span class="hljs-string">&#x27;/stories/:name&#x27;</span> =&gt; <span class="hljs-function"><span class="hljs-title">redirect</span>(<span class="hljs-string">&#x27;/posts/%{name}&#x27;</span>)</span>
</code></pre>
<h3 id="named">Named</h3>

<pre><code># logout_path
match <span class="hljs-symbol">&#x27;exit&#x27;</span> =&gt; <span class="hljs-symbol">&#x27;sessions</span>#destroy&#x27;, <span class="hljs-keyword">as</span>: :logout
</code></pre>
<h3 id="constraints">Constraints</h3>

<pre><code>match <span class="hljs-string">&#x27;/&#x27;</span>, constraints: { subdomain: <span class="hljs-string">&#x27;admin&#x27;</span> }

# admin.site.com/admin/photos
<span class="hljs-keyword">namespace</span> &#x27;<span class="hljs-symbol">admin</span>&#x27; <span class="hljs-symbol">do</span>
  <span class="hljs-symbol">constraints</span> <span class="hljs-symbol">subdomain</span>: &#x27;<span class="hljs-symbol">admin</span>&#x27; <span class="hljs-symbol">do</span>
    <span class="hljs-symbol">resources</span> :<span class="hljs-symbol">photos</span>
  <span class="hljs-symbol">end</span>
<span class="hljs-symbol">end</span>
</code></pre>
<h3 id="custom-constraints">Custom constraints</h3>

<pre><code><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BlacklistConstraint</span></span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span></span>
    <span class="hljs-variable">@ips</span> = Blacklist.retrieve_ips
  <span class="hljs-keyword">end</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">matches?</span><span class="hljs-params">(request)</span></span>
    <span class="hljs-variable">@ips</span>.<span class="hljs-keyword">include</span>?(request.remote_ip)
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

TwitterClone::Application.routes.draw <span class="hljs-keyword">do</span>
  match <span class="hljs-string">&quot;*path&quot;</span> =&gt; <span class="hljs-string">&quot;blacklist#index&quot;</span>,
    <span class="hljs-symbol">:constraints</span> =&gt; BlacklistConstraint.new
<span class="hljs-keyword">end</span>
</code></pre>
<h3 id="scopes">Scopes</h3>

<pre><code>scope <span class="hljs-symbol">&#x27;admin</span>&#x27;, constraints: { subdomain: <span class="hljs-symbol">&#x27;admin</span>&#x27; } <span class="hljs-keyword">do</span>
  resources ...
<span class="hljs-keyword">end</span>
</code></pre>
<h3 id="rack-middleware">Rack middleware</h3>

<pre><code># Yes, Sprockets <span class="hljs-keyword">is</span> middleware
match <span class="hljs-string">&#x27;/application.js&#x27;</span> =&gt; Sprockets
</code></pre>
<h3 id="route-helpers">Route helpers</h3>

<pre><code>projects_path   <span class="hljs-meta"># /projects</span>
projects_url    <span class="hljs-meta"># http:<span class="hljs-comment">//site.com/projects</span></span>
</code></pre>
<h3 id="default-help-text">Default help text</h3>

<pre><code><span class="hljs-comment"># The priority is based upon order of creation:</span>
<span class="hljs-comment"># first created -&gt; highest priority.</span>

<span class="hljs-comment"># Sample of regular route:</span>
match <span class="hljs-string">&#x27;products/:id&#x27;</span> =&gt; <span class="hljs-string">&#x27;catalog#view&#x27;</span>

<span class="hljs-comment"># Keep in mind you can assign values other than :controller and :action</span>

<span class="hljs-comment"># Sample of named route:</span>
match <span class="hljs-string">&#x27;products/:id/purchase&#x27;</span> =&gt; <span class="hljs-string">&#x27;catalog#purchase&#x27;</span>, <span class="hljs-symbol">:as</span> =&gt; <span class="hljs-symbol">:purchase</span>

<span class="hljs-comment"># This route can be invoked with purchase_url(:id =&gt; product.id)</span>

<span class="hljs-comment"># Sample resource route (maps HTTP verbs to controller actions automatically):</span>
resources <span class="hljs-symbol">:products</span>

<span class="hljs-comment"># Sample resource route with options:</span>
resources <span class="hljs-symbol">:products</span> <span class="hljs-keyword">do</span>
  member <span class="hljs-keyword">do</span>
    get <span class="hljs-string">&#x27;short&#x27;</span>
    post <span class="hljs-string">&#x27;toggle&#x27;</span>
  <span class="hljs-keyword">end</span>

  collection <span class="hljs-keyword">do</span>
    get <span class="hljs-string">&#x27;sold&#x27;</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-comment"># Sample resource route with sub-resources:</span>
resources <span class="hljs-symbol">:products</span> <span class="hljs-keyword">do</span>
  resources <span class="hljs-symbol">:comments</span>, <span class="hljs-symbol">:sales</span>
  resource <span class="hljs-symbol">:seller</span>
<span class="hljs-keyword">end</span>

<span class="hljs-comment"># Sample resource route with more complex sub-resources</span>
resources <span class="hljs-symbol">:products</span> <span class="hljs-keyword">do</span>
  resources <span class="hljs-symbol">:comments</span>
  resources <span class="hljs-symbol">:sales</span> <span class="hljs-keyword">do</span>
    get <span class="hljs-string">&#x27;recent&#x27;</span>, <span class="hljs-symbol">:on</span> =&gt; <span class="hljs-symbol">:collection</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-comment"># Sample resource route within a namespace:</span>
namespace <span class="hljs-symbol">:admin</span> <span class="hljs-keyword">do</span>
  <span class="hljs-comment"># Directs /admin/products/* to Admin::ProductsController</span>
  <span class="hljs-comment"># (app/controllers/admin/products_controller.rb)</span>
  resources <span class="hljs-symbol">:products</span>
<span class="hljs-keyword">end</span>

<span class="hljs-comment"># You can have the root of your site routed with &quot;root&quot;</span>
<span class="hljs-comment"># just remember to delete public/index.html.</span>
root <span class="hljs-symbol">:to</span> =&gt; <span class="hljs-string">&#x27;welcome#index&#x27;</span>

<span class="hljs-comment"># See how all your routes lay out with &quot;rake routes&quot;</span>

<span class="hljs-comment"># This is a legacy wild controller route that&#x27;s not recommended for RESTful applications.</span>
<span class="hljs-comment"># Note: This route will make all actions in every controller accessible via GET requests.</span>
match <span class="hljs-string">&#x27;:controller(/:action(/:id(.:format)))&#x27;</span>
</code></pre>
<h3 id="references">References</h3>

<ul>
<li><p><a href="http://guides.rubyonrails.org/routing.html">Guides/Routing</a></p>
</li>
<li><p><a href="http://api.rubyonrails.org/classes/ActionDispatch/Routing/Mapper.html">ActionDispatch::Routing::Mapper</a>
 (See included modules)</p>
</li>
</ul>

</div>
</body>  
</html>