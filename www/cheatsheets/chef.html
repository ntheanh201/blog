<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Chef cheatsheet</title>
  <link href="s/main.css" rel="stylesheet" />
  <script src="s/main.js"></script>
</head>

<body onload="start()">
  <div class="breadcrumbs"><a href="/">Home</a> / <a href="index.html">cheatsheets</a> / Chef cheatsheet</div>
  <div class="edit">
      <a href="https://github.com/kjk/blog/blob/master/www/cheatsheets/devhints\chef.md" >edit</a>
  </div>
  <div class="toc">
<b>Main</b>: <a href="#install">Install</a>, <a href="#start-the-cookbook">Start the cookbook</a>, <a href="#knife">Knife</a>, <a href="#invoking-chef-solo">Invoking chef-solo</a><br>
<b>Examples</b>: <a href="#simple-compile-from-source">Simple compile-from-source</a>, <a href="#remote-file">remote file</a>, <a href="#ruby_block">ruby_block</a>, <a href="#execute">Execute</a>, <a href="#conditions">Conditions</a><br>
<a href="#also-see">Also see</a><br></div>


  <div id="start"></div>
  <div id="wrapped-content"></div>
<div id="content">
<h3 id="install">Install</h3>
<p>In your server:</p>

<pre><code class="bash">$ sudo apt-get install curl
</code></pre>

<pre><code class="bash">$ curl -L https://omnitruck.chef.io/install.sh | sudo bash
Thank you <span class="hljs-keyword">for</span> installing Chef!
</code></pre>

<pre><code class="bash">$ chef-solo -v
...
Chef: 14.5.33
</code></pre>
<h3 id="start-the-cookbook">Start the cookbook</h3>

<pre><code class="bash"> wget http://github.com/chef-cookbooks/chef-repo/tarball/master -O - | tar xzf - --strip-components=1
</code></pre>
<h3 id="knife">Knife</h3>

<pre><code class="bash">$ knife supermarket download mysql
</code></pre>
<h3 id="invoking-chef-solo">Invoking chef-solo</h3>

<pre><code class="bash">$ chef-solo -c solo.rb -j web.json
</code></pre>
<h2 id="examples">Examples</h2>
<h3 id="simple-compile-from-source">Simple compile-from-source</h3>

<pre><code class="ruby">execute <span class="hljs-string">&quot;tar --no-same-owner -zxf hi.tar.gz&quot;</span> <span class="hljs-keyword">do</span>
  cwd <span class="hljs-string">&quot;/usr/local/src&quot;</span>
  creates <span class="hljs-string">&quot;/usr/local/src/node-v<span class="hljs-subst">#{version}</span>&quot;</span>
<span class="hljs-keyword">end</span>
</code></pre>

<pre><code class="ruby">bash <span class="hljs-string">&quot;compile&quot;</span> <span class="hljs-keyword">do</span>
  cwd <span class="hljs-string">&quot;/usr/local/src/node-v<span class="hljs-subst">#{version}</span>&quot;</span>
  code <span class="hljs-string">%[
    PATH=/usr/local/bin:$PATH
    ./configure
    make
  ]</span>
  creates <span class="hljs-string">&quot;/usr/local/src/node-v<span class="hljs-subst">#{version}</span>/node&quot;</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h3 id="remote-file">remote file</h3>

<pre><code class="ruby">remote_file <span class="hljs-string">&quot;/usr/local/src/hi.tar.gz&quot;</span> <span class="hljs-keyword">do</span>
  source <span class="hljs-string">&quot;http://...&quot;</span>
  checksum <span class="hljs-string">&quot;ab83be...&quot;</span>
  mode <span class="hljs-number">0644</span>
  action <span class="hljs-symbol">:create_if_missing</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h3 id="ruby_block">ruby_block</h3>

<pre><code class="ruby">ruby_block <span class="hljs-string">&quot;name&quot;</span> <span class="hljs-keyword">do</span>
  block { File.read ... }
  not_if { File.exists?(...) }
<span class="hljs-keyword">end</span>
</code></pre>
<h3 id="execute">Execute</h3>

<pre><code class="ruby">execute <span class="hljs-string">&quot;name&quot;</span> <span class="hljs-keyword">do</span>
  cwd <span class="hljs-string">&quot;...&quot;</span>
  environment({ <span class="hljs-string">&quot;PATH&quot;</span> =&gt; <span class="hljs-string">&quot;...&quot;</span> })
  command <span class="hljs-string">&quot;make install&quot;</span>
  creates <span class="hljs-string">&quot;...&quot;</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h3 id="conditions">Conditions</h3>

<pre><code class="ruby">  creates <span class="hljs-string">&quot;/usr/local/src/node-v<span class="hljs-subst">#{version}</span>/node&quot;</span>
  not_if { File.exists?(<span class="hljs-string">&#x27;...&#x27;</span>) }
</code></pre>
<h2 id="also-see">Also see</h2>

<ul>
<li><a href="https://learn.chef.io">Learn Chef Rally</a> <em>(learn.chef.io)</em></li>
<li><a href="https://github.com/mdxp/nodejs-cookbook/blob/master/recipes/install_from_source.rb">install_from_source.rb recipe</a> <em>(github.com)</em></li>
</ul>

</div>
</body>  
</html>