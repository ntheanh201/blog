<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Devise cheatsheet</title>
  <link href="s/main.css" rel="stylesheet" />
  <script src="s/main.js"></script>
</head>

<body onload="start()">
  <div class="breadcrumbs"><a href="/">Home</a> / <a href="index.html">cheatsheets</a> / Devise cheatsheet</div>
  <div class="edit">
      <a href="https://github.com/kjk/blog/blob/master/www/cheatsheets/devhints/devise.md" >edit</a>
  </div>
  <div class="toc">
<a href="#installation">Installation</a><br>
<a href="#helpers">Helpers</a><br>
<a href="#controller-stuff">Controller stuff</a><br>
<b>Model</b>: <a href="#model-options">Model options</a>, <a href="#migration-helpers">Migration helpers</a><br>
<b>Routing</b>: <a href="#authenticated-and-unauthenticated-routes">Authenticated and unauthenticated routes</a>, <a href="#as">As</a>, <a href="#devise_for-magic">Devise_for magic</a>, <a href="#customizing-devise_for">Customizing devise_for</a><br>
<a href="#test-helpers">Test helpers</a><br></div>


  <div id="start"></div>
  <div id="wrapped-content"></div>
<div id="content">
<p><a href="https://github.com/plataformatec/devise">Devise</a> is a flexible authentication 
gem.</p>
<h2 id="installation">Installation</h2>
<p>Rails 3: Add the following to your Gemfile</p>

<pre><code><span class="hljs-attribute">gem</span> <span class="hljs-string">&quot;devise&quot;</span>
gem <span class="hljs-string">&quot;hpricot&quot;</span>
gem <span class="hljs-string">&quot;ruby_parser&quot;</span>
</code></pre>
<p>Install devise in your project</p>

<pre><code>$ rails <span class="hljs-keyword">generate</span> devise:install
</code></pre>
<p>Generate devise for your model</p>

<pre><code>$ rails <span class="hljs-keyword">generate</span> devise MODEL
$ rake db:migrate
</code></pre>
<p>(Optional) Generate devise views</p>

<pre><code>$ rails <span class="hljs-keyword">generate</span> devise:views
</code></pre>
<h2 id="helpers">Helpers</h2>

<pre><code>user_signed_in?
current_user
user_session
destroy_user_session_path (Logout)
<span class="hljs-keyword">new</span><span class="hljs-type">_user_session_path</span> (Login)
edit_user_registration_path (Edit registration)
<span class="hljs-keyword">new</span><span class="hljs-type">_user_registration_path</span> (Register <span class="hljs-keyword">new</span> <span class="hljs-type">user</span>)
</code></pre>
<h2 id="controller-stuff">Controller stuff</h2>

<pre><code>before_filter <span class="hljs-symbol">:authenticate_user!</span>
</code></pre>
<h2 id="model">Model</h2>
<h3 id="model-options">Model options</h3>

<pre><code><span class="hljs-keyword">class</span> <span class="hljs-symbol">User</span> &lt; <span class="hljs-symbol">ActiveRecord::<span class="hljs-symbol">Base</span></span>
  <span class="hljs-symbol">devise</span> :<span class="hljs-symbol">database_authenticatable,
    :<span class="hljs-symbol">registerable</span>,
    :<span class="hljs-symbol">confirmable</span>,
    :<span class="hljs-symbol">recoverable</span>,
    :<span class="hljs-symbol">rememberable</span>,
    :<span class="hljs-symbol">trackable</span>,
    :<span class="hljs-symbol">validatable</span></span>
<span class="hljs-symbol">end</span>
</code></pre>
<h3 id="migration-helpers">Migration helpers</h3>

<pre><code>create_table :users <span class="hljs-built_in">do</span> |<span class="hljs-type">t</span>|
  <span class="hljs-type">t</span>.database_authenticatable
  t.confirmable
  t.recoverable
  t.rememberable
  t.trackable
  t.timestamps
<span class="hljs-keyword">end</span>
</code></pre>
<h2 id="routing">Routing</h2>
<h3 id="authenticated-and-unauthenticated-routes">Authenticated and unauthenticated routes</h3>

<pre><code>unauthenticated <span class="hljs-keyword">do</span>
   root :to =&gt; <span class="hljs-symbol">&#x27;home</span>#index&#x27;
<span class="hljs-keyword">end</span>

authenticated <span class="hljs-keyword">do</span>
  root :to =&gt; <span class="hljs-symbol">&#x27;dashboard</span>#index&#x27;
<span class="hljs-keyword">end</span>
</code></pre>
<h3 id="as">As</h3>

<pre><code><span class="hljs-keyword">as</span> :<span class="hljs-keyword">user</span> <span class="hljs-keyword">do</span>
  <span class="hljs-keyword">get</span> <span class="hljs-string">&#x27;sign_in&#x27;</span>, :<span class="hljs-keyword">to</span> =&gt; <span class="hljs-string">&#x27;devise/sessions#new&#x27;</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h3 id="devise_for-magic">Devise_for magic</h3>

<pre><code>devise_for :users

    <span class="hljs-comment"># Session routes for Authenticatable (default)</span>
         new_user_session GET  <span class="hljs-regexp">/users/</span>sign_in                    
             user_session POST <span class="hljs-regexp">/users/</span>sign_in                    
     destroy_user_session GET  <span class="hljs-regexp">/users/</span>sign_out                   

    <span class="hljs-comment"># Password routes for Recoverable, if User model has :recoverable configured</span>
        new_user_password GET  <span class="hljs-regexp">/users/</span>password/new(.:format)     
       edit_user_password GET  <span class="hljs-regexp">/users/</span>password/edit(.:format)    
            user_password PUT  <span class="hljs-regexp">/users/</span>password(.:format)         
                          POST <span class="hljs-regexp">/users/</span>password(.:format)         

    <span class="hljs-comment"># Confirmation routes for Confirmable, if User model has :confirmable configured</span>
    new_user_confirmation GET  <span class="hljs-regexp">/users/</span>confirmation/new(.:format) 
        user_confirmation GET  <span class="hljs-regexp">/users/</span>confirmation(.:format)     
                          POST <span class="hljs-regexp">/users/</span>confirmation(.:format)     
</code></pre>
<h3 id="customizing-devise_for">Customizing devise_for</h3>

<pre><code>devise_for :users,
  :<span class="hljs-function"><span class="hljs-params">path</span> =&gt;</span> <span class="hljs-string">&quot;usuarios&quot;</span>,
  :<span class="hljs-function"><span class="hljs-params">path_names</span> =&gt;</span> {
    :<span class="hljs-function"><span class="hljs-params">sign_in</span> =&gt;</span> <span class="hljs-string">&#x27;login&#x27;</span>,
    :<span class="hljs-function"><span class="hljs-params">sign_out</span> =&gt;</span> <span class="hljs-string">&#x27;logout&#x27;</span>,
    :<span class="hljs-function"><span class="hljs-params">password</span> =&gt;</span> <span class="hljs-string">&#x27;secret&#x27;</span>,
    :<span class="hljs-function"><span class="hljs-params">confirmation</span> =&gt;</span> <span class="hljs-string">&#x27;verification&#x27;</span>,
    :<span class="hljs-function"><span class="hljs-params">unlock</span> =&gt;</span> <span class="hljs-string">&#x27;unblock&#x27;</span>,
    :<span class="hljs-function"><span class="hljs-params">registration</span> =&gt;</span> <span class="hljs-string">&#x27;register&#x27;</span>,
    :<span class="hljs-function"><span class="hljs-params">sign_up</span> =&gt;</span> <span class="hljs-string">&#x27;cmon_let_me_in&#x27;</span> }
</code></pre>
<h2 id="test-helpers">Test helpers</h2>

<pre><code>include Devise::TestHelpers
https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/plataformatec/</span>devise<span class="hljs-regexp">/blob/</span><span class="hljs-number">1094</span>ba65aac1d37713f2cba71f9edad76b5ca274<span class="hljs-regexp">/lib/</span>devise/test_helpers.rb

sign_in @user
sign_out @user
</code></pre>

</div>
</body>  
</html>