<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Mocha blanket cheatsheet</title>
  <link href="s/main.css" rel="stylesheet" />
  <script src="s/main.js"></script>
</head>

<body onload="start()">
  <div class="breadcrumbs"><a href="/">Home</a> / <a href="index.html">cheatsheets</a> / Mocha blanket cheatsheet</div>
  <div class="edit">
      <a href="https://github.com/kjk/blog/blob/master/www/cheatsheets/devhints\mocha-blanket.md" >edit</a>
  </div>
  <div class="toc">
<b>Main</b>: <a href="#quickstart-guide">Quickstart guide</a>, <a href="#travis-coveralls-io-support">Travis + coveralls.io support</a><br></div>


  <div id="start"></div>
  <div id="wrapped-content"></div>
<div id="content">
<h3 id="quickstart-guide">Quickstart guide</h3>
<p>Install blanket:</p>

<pre><code class="bash">npm i --save-dev blanket
</code></pre>
<p>In your test helpers, use Blanket before <code>require</code>ing:</p>

<pre><code class="js"><span class="hljs-keyword">if</span> (process.<span class="hljs-property">env</span>.<span class="hljs-property">COVERAGE</span>) {
  <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;blanket&#x27;</span>)({
    <span class="hljs-attr">pattern</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>).<span class="hljs-title function_">resolve</span>(<span class="hljs-string">&#x27;./index.js&#x27;</span>)
  });
}
thing = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../index&#x27;</span>);
</code></pre>
<p>Add to <code>package.json</code>:</p>

<pre><code class="json"><span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;coverage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;env COVERAGE=1 mocha -R html-cov &gt; coverage.html &amp;&amp; open coverage.html&quot;</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>Be sure to ignore it:</p>

<pre><code class="bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;coverage.html&quot;</span> &gt;&gt; .gitignore
</code></pre>
<p>Then run:</p>

<pre><code class="bash">npm run coverage
</code></pre>
<h3 id="travis-coveralls-io-support">Travis + coveralls.io support</h3>
<p>Visit <a href="http://coveralls.io">coveralls.io</a> then activate your repo. Then install the appropriate packages:</p>

<pre><code class="bash">npm i --save-dev mocha-lcov-reporter coveralls
</code></pre>
<p>Add this to <code>.travis.yml</code>:</p>

<pre><code class="yml"><span class="hljs-attr">after_success:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">./node_modules/.bin/mocha</span> <span class="hljs-string">-R</span> <span class="hljs-string">mocha-lcov-reporter</span> <span class="hljs-string">|</span> <span class="hljs-string">./node_modules/coveralls/bin/coveralls.js</span>
</code></pre>
<p>Commit, push, wait for Travis to finish.</p>

</div>
</body>  
</html>