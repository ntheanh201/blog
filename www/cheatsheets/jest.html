<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Jest cheatsheet</title>
  <link href="s/main.css" rel="stylesheet" />
  <script src="s/main.js"></script>
</head>

<body onload="start()">
  <div class="breadcrumbs"><a href="/">Home</a> / <a href="index.html">cheatsheets</a> / Jest cheatsheet</div>
  <div class="edit">
      <a href="https://github.com/kjk/blog/blob/master/www/cheatsheets/devhints/jest.md" >edit</a>
  </div>
  <div class="toc">
<b>Testing</b>: <a href="#quick-start">Quick start</a>, <a href="#writing-tests">Writing tests</a>, <a href="#bdd-syntax">BDD syntax</a>, <a href="#setup">Setup</a>, <a href="#focusing-tests">Focusing tests</a>, <a href="#skipping-tests">Skipping tests</a>, <a href="#optional-flags">Optional flags</a><br>
<b>Expect</b>: <a href="#basic-expectations">Basic expectations</a>, <a href="#snapshots">Snapshots</a>, <a href="#errors">Errors</a>, <a href="#booleans">Booleans</a>, <a href="#numbers">Numbers</a>, <a href="#objects">Objects</a>, <a href="#objects1">Objects</a>, <a href="#strings">Strings</a>, <a href="#others">Others</a><br>
<b>More features</b>: <a href="#asynchronous-tests">Asynchronous tests</a>, <a href="#snapshots1">Snapshots</a>, <a href="#react-test-renderer">React test renderer</a>, <a href="#timers">Timers</a><br>
<b>Mock functions</b>: <a href="#mock-functions1">Mock functions</a>, <a href="#assertions">Assertions</a>, <a href="#instances">Instances</a>, <a href="#calls">Calls</a>, <a href="#return-values">Return values</a>, <a href="#mock-implementations">Mock implementations</a><br>
<a href="#references">References</a><br></div>


  <div id="start"></div>
  <div id="wrapped-content"></div>
<div id="content">
<h2 id="testing">Testing</h2>
<h3 id="quick-start">Quick start</h3>

<pre><code class="bash">npm install --save-dev jest babel-jest
</code></pre>

<pre><code class="js"><span class="hljs-comment">/* Add to package.json */</span>
<span class="hljs-string">&quot;scripts&quot;</span>: {
  <span class="hljs-string">&quot;test&quot;</span>: <span class="hljs-string">&quot;jest&quot;</span>
}
</code></pre>

<pre><code class="bash"><span class="hljs-comment"># Run your tests</span>
npm <span class="hljs-built_in">test</span> -- --watch
</code></pre>
<p>See: <a href="http://facebook.github.io/jest/docs/en/getting-started.html">Getting started</a></p>
<h3 id="writing-tests">Writing tests</h3>

<pre><code class="js"><span class="hljs-title function_">describe</span>(<span class="hljs-string">&#x27;My work&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;works&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">expect</span>(<span class="hljs-number">2</span>).<span class="hljs-title function_">toEqual</span>(<span class="hljs-number">2</span>)
  })
})
</code></pre>
<p>See: <a href="http://facebook.github.io/jest/docs/en/api.html#describename-fn">describe()</a>, <a href="http://facebook.github.io/jest/docs/en/api.html#testname-fn">test()</a>, <a href="http://facebook.github.io/jest/docs/en/expect.html#content">expect()</a></p>
<h3 id="bdd-syntax">BDD syntax</h3>

<pre><code class="js"><span class="hljs-title function_">describe</span>(<span class="hljs-string">&#x27;My work&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;works&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    ···
  })
})
</code></pre>
<p><code>it</code> is an alias for <code>test</code>.
See: <a href="http://facebook.github.io/jest/docs/en/api.html#testname-fn">test()</a></p>
<h3 id="setup">Setup</h3>

<pre><code class="js"><span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">() =&gt;</span> { ... })
<span class="hljs-title function_">afterEach</span>(<span class="hljs-function">() =&gt;</span> { ... })
</code></pre>

<pre><code class="js"><span class="hljs-title function_">beforeAll</span>(<span class="hljs-function">() =&gt;</span> { ... })
<span class="hljs-title function_">afterAll</span>(<span class="hljs-function">() =&gt;</span> { ... })
</code></pre>
<p>See: <a href="http://facebook.github.io/jest/docs/en/api.html#afterallfn">afterAll() and more</a></p>
<h3 id="focusing-tests">Focusing tests</h3>

<pre><code class="js">describe.<span class="hljs-title function_">only</span>(···)
it.<span class="hljs-title function_">only</span>(···) <span class="hljs-comment">// alias: fit()</span>
</code></pre>
<p>See: <a href="http://facebook.github.io/jest/docs/en/api.html#testonlyname-fn">test.only</a></p>
<h3 id="skipping-tests">Skipping tests</h3>

<pre><code class="js">describe.<span class="hljs-title function_">skip</span>(···)
it.<span class="hljs-title function_">skip</span>(···) <span class="hljs-comment">// alias: xit()</span>
</code></pre>
<p>See: <a href="http://facebook.github.io/jest/docs/en/api.html#testskipname-fn">test.skip</a></p>
<h3 id="optional-flags">Optional flags</h3>

<table>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--coverage</code></td>
<td>See a summary of test coverage</td>
</tr>
<tr>
<td><code>--detectOpenHandles</code></td>
<td>See a summary of ports that didn&#39;t close</td>
</tr>
<tr>
<td><code>--runInBand</code></td>
<td>Run all tests one after the other</td>
</tr>
</tbody>
</table>
<h2 id="expect">Expect</h2>
<h3 id="basic-expectations">Basic expectations</h3>

<pre><code class="js"><span class="hljs-title function_">expect</span>(value)
  .<span class="hljs-property">not</span>
  .<span class="hljs-title function_">toBe</span>(value)
  .<span class="hljs-title function_">toEqual</span>(value)
  .<span class="hljs-title function_">toBeTruthy</span>()
</code></pre>
<p>Note that <code>toEqual</code> is a deep equality check.
See: <a href="http://facebook.github.io/jest/docs/en/expect.html#expectvalue">expect()</a></p>
<h3 id="snapshots">Snapshots</h3>

<pre><code class="js"><span class="hljs-title function_">expect</span>(value)
  .<span class="hljs-title function_">toMatchSnapshot</span>()
  .<span class="hljs-title function_">toMatchInlineSnapshot</span>()
</code></pre>
<p>Note that <code>toMatchInlineSnapshot()</code> requires Prettier to be set up for the project.
See: <a href="https://jestjs.io/docs/en/snapshot-testing#inline-snapshots">Inline snapshots</a></p>
<h3 id="errors">Errors</h3>

<pre><code class="js"><span class="hljs-title function_">expect</span>(value)
  .<span class="hljs-title function_">toThrow</span>(error)
  .<span class="hljs-title function_">toThrowErrorMatchingSnapshot</span>()
</code></pre>
<h3 id="booleans">Booleans</h3>

<pre><code class="js"><span class="hljs-title function_">expect</span>(value)
  .<span class="hljs-title function_">toBeFalsy</span>()
  .<span class="hljs-title function_">toBeNull</span>()
  .<span class="hljs-title function_">toBeTruthy</span>()
  .<span class="hljs-title function_">toBeUndefined</span>()
  .<span class="hljs-title function_">toBeDefined</span>()
</code></pre>
<h3 id="numbers">Numbers</h3>

<pre><code class="js"><span class="hljs-title function_">expect</span>(value)
  .<span class="hljs-title function_">toBeCloseTo</span>(number, numDigits)
  .<span class="hljs-title function_">toBeGreaterThan</span>(number)
  .<span class="hljs-title function_">toBeGreaterThanOrEqual</span>(number)
  .<span class="hljs-title function_">toBeLessThan</span>(number)
  .<span class="hljs-title function_">toBeLessThanOrEqual</span>(number)
</code></pre>
<h3 id="objects">Objects</h3>

<pre><code class="js"><span class="hljs-title function_">expect</span>(value)
  .<span class="hljs-title function_">toBeInstanceOf</span>(<span class="hljs-title class_">Class</span>)
  .<span class="hljs-title function_">toMatchObject</span>(object)
  .<span class="hljs-title function_">toHaveProperty</span>(keyPath, value)
</code></pre>
<h3 id="objects1">Objects</h3>

<pre><code class="js"><span class="hljs-title function_">expect</span>(value)
  .<span class="hljs-title function_">toContain</span>(item)
  .<span class="hljs-title function_">toContainEqual</span>(item)
  .<span class="hljs-title function_">toHaveLength</span>(number)
</code></pre>
<h3 id="strings">Strings</h3>

<pre><code class="js"><span class="hljs-title function_">expect</span>(value)
  .<span class="hljs-title function_">toMatch</span>(regexpOrString)
</code></pre>
<h3 id="others">Others</h3>

<pre><code class="js">expect.<span class="hljs-title function_">extend</span>(matchers)
expect.<span class="hljs-title function_">any</span>(constructor)
expect.<span class="hljs-title function_">addSnapshotSerializer</span>(serializer)

expect.<span class="hljs-title function_">assertions</span>(<span class="hljs-number">1</span>)
</code></pre>
<h2 id="more-features">More features</h2>
<h3 id="asynchronous-tests">Asynchronous tests</h3>

<pre><code class="js"><span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;works with promises&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    ···
  })
})
</code></pre>

<pre><code class="js"><span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;works with async/await&#x27;</span>, <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">const</span> hello = <span class="hljs-keyword">await</span> <span class="hljs-title function_">foo</span>()
  ···
})
</code></pre>
<p>Return promises, or use async/await.
See: <a href="http://facebook.github.io/jest/docs/en/tutorial-async.html">Async tutorial</a></p>
<h3 id="snapshots1">Snapshots</h3>

<pre><code class="jsx"><span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;works&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> output = <span class="hljs-title function_">something</span>()
  <span class="hljs-title function_">expect</span>(output).<span class="hljs-title function_">toMatchSnapshot</span>()
})
</code></pre>
<p>First run creates a snapshot. Subsequent runs match the saved snapshot.
See: <a href="http://facebook.github.io/jest/docs/en/snapshot-testing.html">Snapshot testing</a></p>
<h3 id="react-test-renderer">React test renderer</h3>

<pre><code class="jsx"><span class="hljs-keyword">import</span> renderer <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-test-renderer&#x27;</span>
</code></pre>

<pre><code class="jsx"><span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;works&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> tree = renderer.<span class="hljs-title function_">create</span>(
    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">page</span>=<span class="hljs-string">&quot;http://www.facebook.com&quot;</span>&gt;</span>Facebook<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span></span>
  ).<span class="hljs-title function_">toJSON</span>()

  <span class="hljs-title function_">expect</span>(tree).<span class="hljs-title function_">toMatchSnapshot</span>()
})
</code></pre>
<p>React&#39;s test renderer can be used for Jest snapshots.
See: <a href="http://facebook.github.io/jest/docs/en/tutorial-react-native.html#snapshot-test">Snapshot test</a></p>
<h3 id="timers">Timers</h3>

<pre><code class="js">jest.<span class="hljs-title function_">useFakeTimers</span>()
</code></pre>

<pre><code class="js"><span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;works&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  jest.<span class="hljs-title function_">runOnlyPendingTimers</span>()
  jest.<span class="hljs-title function_">runTimersToTime</span>(<span class="hljs-number">1000</span>)
  jest.<span class="hljs-title function_">runAllTimers</span>()
})
</code></pre>
<p>See: <a href="http://facebook.github.io/jest/docs/en/timer-mocks.html">Timer Mocks</a></p>
<h2 id="mock-functions">Mock functions</h2>
<h3 id="mock-functions1">Mock functions</h3>

<pre><code class="js"><span class="hljs-keyword">const</span> fn = jest.<span class="hljs-title function_">fn</span>()
</code></pre>

<pre><code class="js"><span class="hljs-keyword">const</span> fn = jest.<span class="hljs-title function_">fn</span>(<span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> n * n)
</code></pre>
<p>See: <a href="http://facebook.github.io/jest/docs/en/mock-functions.html#using-a-mock-function">Mock functions</a></p>
<h3 id="assertions">Assertions</h3>

<pre><code class="js"><span class="hljs-title function_">expect</span>(fn)
  .<span class="hljs-title function_">toHaveBeenCalled</span>()
  .<span class="hljs-title function_">toHaveBeenCalledTimes</span>(number)
  .<span class="hljs-title function_">toHaveBeenCalledWith</span>(arg1, arg2, ...)
  .<span class="hljs-title function_">toHaveBeenLastCalledWith</span>(arg1, arg2, ...)
</code></pre>

<pre><code class="js"><span class="hljs-title function_">expect</span>(fn)
  .<span class="hljs-title function_">toHaveBeenCalledWith</span>(expect.<span class="hljs-title function_">anything</span>())
  .<span class="hljs-title function_">toHaveBeenCalledWith</span>(expect.<span class="hljs-title function_">any</span>(constructor))
  .<span class="hljs-title function_">toHaveBeenCalledWith</span>(expect.<span class="hljs-title function_">arrayContaining</span>([ values ]))
  .<span class="hljs-title function_">toHaveBeenCalledWith</span>(expect.<span class="hljs-title function_">objectContaining</span>({ props }))
  .<span class="hljs-title function_">toHaveBeenCalledWith</span>(expect.<span class="hljs-title function_">stringContaining</span>(string))
  .<span class="hljs-title function_">toHaveBeenCalledWith</span>(expect.<span class="hljs-title function_">stringMatching</span>(regexp))
</code></pre>
<h3 id="instances">Instances</h3>

<pre><code class="js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Fn</span> = jest.<span class="hljs-title function_">fn</span>()

a = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Fn</span>()
b = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Fn</span>()
</code></pre>

<pre><code class="js"><span class="hljs-title class_">Fn</span>.<span class="hljs-property">mock</span>.<span class="hljs-property">instances</span>
<span class="hljs-comment">// → [a, b]</span>
</code></pre>
<p>See: <a href="http://facebook.github.io/jest/docs/en/mock-functions.html#mock-property">.mock property</a></p>
<h3 id="calls">Calls</h3>

<pre><code class="js"><span class="hljs-keyword">const</span> fn = jest.<span class="hljs-title function_">fn</span>()
<span class="hljs-title function_">fn</span>(<span class="hljs-number">123</span>)
<span class="hljs-title function_">fn</span>(<span class="hljs-number">456</span>)
</code></pre>

<pre><code class="js">fn.<span class="hljs-property">mock</span>.<span class="hljs-property">calls</span>.<span class="hljs-property">length</span>   <span class="hljs-comment">// → 2</span>
fn.<span class="hljs-property">mock</span>.<span class="hljs-property">calls</span>[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]    <span class="hljs-comment">// → 123</span>
fn.<span class="hljs-property">mock</span>.<span class="hljs-property">calls</span>[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]    <span class="hljs-comment">// → 456</span>
</code></pre>
<p>See: <a href="http://facebook.github.io/jest/docs/en/mock-functions.html#mock-property">.mock property</a></p>
<h3 id="return-values">Return values</h3>

<pre><code class="js"><span class="hljs-keyword">const</span> fn = jest.<span class="hljs-title function_">fn</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-string">&#x27;hello&#x27;</span>)
</code></pre>
<h4 id="or-">or:</h4>

<pre><code class="js">jest.<span class="hljs-title function_">fn</span>().<span class="hljs-title function_">mockReturnValue</span>(<span class="hljs-string">&#x27;hello&#x27;</span>)
jest.<span class="hljs-title function_">fn</span>().<span class="hljs-title function_">mockReturnValueOnce</span>(<span class="hljs-string">&#x27;hello&#x27;</span>)
</code></pre>
<h3 id="mock-implementations">Mock implementations</h3>

<pre><code class="js"><span class="hljs-keyword">const</span> fn = jest.<span class="hljs-title function_">fn</span>()
  .<span class="hljs-title function_">mockImplementationOnce</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-number">1</span>)
  .<span class="hljs-title function_">mockImplementationOnce</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-number">2</span>)
</code></pre>

<pre><code class="js"><span class="hljs-title function_">fn</span>()    <span class="hljs-comment">// → 1</span>
<span class="hljs-title function_">fn</span>()    <span class="hljs-comment">// → 2</span>
</code></pre>
<h2 id="references">References</h2>

<ul>
<li><a href="http://facebook.github.io/jest/">http://facebook.github.io/jest/</a></li>
</ul>

</div>
</body>  
</html>